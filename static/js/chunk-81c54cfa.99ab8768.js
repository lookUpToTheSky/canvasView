(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-81c54cfa"],{4585:function(e,t,s){"use strict";s.r(t);var i=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"wrap"},[s("div",{staticClass:"head-title"},[s("i",{staticClass:"el-icon-success"}),e._v(" "+e._s(e.isEdit?"编辑":"添加")+"设备")]),s("ul",{staticClass:"equipmentInfo"},[s("li",[s("label",[e._v("设备分组")]),s("el-select",{staticClass:"select",attrs:{disabled:e.isEdit,size:"small",placeholder:"选择设备组"},model:{value:e.value,callback:function(t){e.value=t},expression:"value"}},e._l(e.group,(function(e,t){return s("el-option",{key:t,attrs:{value:e.groupName,label:e.groupName}})})),1),s("el-button",{directives:[{name:"show",rawName:"v-show",value:!e.isEdit,expression:"!isEdit"}],attrs:{type:"primary",size:"small"},on:{click:function(t){e.userEquipmentGroupShow=!0}}},[s("i",{staticClass:"el-icon-plus"})])],1),s("li",[s("label",[e._v("设备名称")]),s("el-input",{staticClass:"select",attrs:{placeholder:"请输入设备名称",size:"small"},model:{value:e.equipmentName,callback:function(t){e.equipmentName=t},expression:"equipmentName"}})],1),s("li",[s("label",[e._v("传感器")]),s("el-button",{staticClass:"add-button",attrs:{type:"primary",size:"small"},on:{click:function(t){return e.addSensor(1)}}},[e._v("添加")]),s("el-button",{staticClass:"add-button",attrs:{type:"primary",size:"small",plain:""},on:{click:function(t){return e.addSensor(2)}}},[e._v("批量添加")]),s("div",{staticClass:"sensorList"},e._l(e.sensorList,(function(t,i){return s("div",{key:i,staticClass:"sensor"},[s("el-input",{staticClass:"add-button",attrs:{size:"small",placeholder:"传感器名称"},model:{value:t.name,callback:function(s){e.$set(t,"name",s)},expression:"item.name"}}),s("el-select",{staticClass:"add-button",attrs:{size:"small",placeholder:"类型"},model:{value:t.type,callback:function(s){e.$set(t,"type",s)},expression:"item.type"}},e._l(e.sensorType,(function(e){return s("el-option",{key:e.vlaue,attrs:{value:e.value,label:e.type}})})),1),s("el-button",{attrs:{type:"danger",size:"small",plain:""},on:{click:function(t){return e.deleteSensor(i)}}},[e._v("删除")])],1)})),0)],1),s("li",[s("el-button",{staticClass:"add-button",attrs:{type:"primary",size:"small"},on:{click:e.onsmbmit}},[e._v("确定"+e._s(e.isEdit?"编辑":"添加")+"此设备")])],1)]),s("el-dialog",{attrs:{title:"批量添加传感器",visible:e.centerDialogVisible,width:"375px"},on:{"update:visible":function(t){e.centerDialogVisible=t}}},[s("ul",{staticClass:"addLotSensor"},[s("li",[s("span",[e._v("数量："),s("small",{attrs:{type:"priamry"}},[e._v("(必填)")])]),s("el-input-number",{staticClass:"inputW",attrs:{size:"small",min:1,max:50},model:{value:e.addNum,callback:function(t){e.addNum=t},expression:"addNum"}})],1),s("li",[s("span",[e._v("名称前缀："),s("small",[e._v("(可选)")])]),s("el-input",{staticClass:"inputW",attrs:{size:"small"},model:{value:e.addName,callback:function(t){e.addName=t},expression:"addName"}})],1),s("li",[s("span",[e._v("类型："),s("small",[e._v("(必填)")])]),s("el-select",{staticClass:"inputW",attrs:{size:"small",placeholder:"类型"},model:{value:e.addType,callback:function(t){e.addType=t},expression:"addType"}},e._l(e.sensorType,(function(e){return s("el-option",{key:e.value,attrs:{value:e.value,label:e.type}})})),1)],1)]),s("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{attrs:{size:"small"},on:{click:function(t){e.centerDialogVisible=!1}}},[e._v("取 消")]),s("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.addLotSensor}},[e._v("确 定")])],1)]),s("el-dialog",{attrs:{title:"设备组",visible:e.equipmentWarn,width:"30%"},on:{"update:visible":function(t){e.equipmentWarn=t}}},[s("span",[e._v("设备未提交，是否提交？")]),s("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:e.onLeave}},[e._v("放弃提交")]),s("el-button",{attrs:{type:"primary"},on:{click:e.onsmbmit}},[e._v("提交设备")])],1)]),s("el-dialog",{attrs:{title:"设备组名称",visible:e.userEquipmentGroupShow,width:"30%"},on:{"update:visible":function(t){e.userEquipmentGroupShow=t}}},[s("el-input",{attrs:{placeholder:"请输入设备组名称"},model:{value:e.groupName,callback:function(t){e.groupName=t},expression:"groupName"}}),s("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:function(t){e.userEquipmentGroupShow=!1}}},[e._v("取消")]),s("el-button",{attrs:{type:"primary"},on:{click:e.onAddEquipmentGroup}},[e._v("确定")])],1)],1)],1)},a=[],n=s("c1f9"),o=s("a19a"),l=(s("8d1b"),s("a9b6"),s("c284"),s("3e22"),s("5422")),r={data:function(){return{value:null,isEdit:!1,index:0,centerDialogVisible:!1,equipmentWarn:!1,userEquipmentGroupShow:!1,sensorList:[],group:[],groupName:null,equipmentName:"",addNum:5,addName:null,addType:"1",goPath:"",sensorType:[{value:"1",type:"开关型"},{value:"2",type:"数字型"},{value:"3",type:"信息型"}]}},methods:{onAddEquipmentGroup:function(){this.group.push({groupName:this.groupName,equipmentList:[]}),this.$store.commit("addEquipmentGroup",this.group),this.userEquipmentGroupShow=!1,this.value=this.groupName},addSensor:function(e){1===e?this.sensorList.unshift({name:"",type:"1"}):(this.centerDialogVisible=!0,this.addNum=5,this.addType="1",this.addName=null)},addLotSensor:function(){var e={name:this.addName,type:this.addType,state:0};if(this.addNum&&this.addType){for(var t=0;t<this.addNum;t++)this.sensorList.unshift(Object(o["a"])({},e));this.centerDialogVisible=!1}else Object(l["Notification"])({type:"warning",message:"添加失败！必填项未完成！"})},deleteSensor:function(e){this.sensorList.splice(e,1)},onsmbmit:function(){var e=this;this.group.forEach((function(t,s){t.groupName===e.value&&(e.isEdit?e.group[s].equipmentList[e.index]={equipmentName:e.equipmentName,buildTime:(new Date).getTime(),sensorList:e.sensorList}:e.group[s].equipmentList.unshift({equipmentName:e.equipmentName,buildTime:(new Date).getTime(),sensorList:e.sensorList}))})),this.isEdit||(this.sensorList=[]),this.$store.commit("addEquipmentGroup",Object(n["a"])(this.group)),Object(l["Notification"])({type:"success",message:"提交成功"}),this.goPath&&this.onLeave()},onLeave:function(){this.equipmentWarn=!1,this.sensorList=[],this.$router.push(this.goPath)}},beforeRouteEnter:function(e,t,s){e.query.name?s((function(t){t.value=e.query.name})):e.query.equipment?s((function(t){t.isEdit=!0;var s=JSON.parse(e.query.equipment);t.index=e.query.index,t.value=e.query.groupName,t.equipmentName=s.equipmentName,t.sensorList=s.sensorList})):s()},beforeRouteLeave:function(e,t,s){this.sensorList.length>0&&!this.isEdit?(this.goPath=e.path,this.equipmentWarn=!0):s()},mounted:function(){this.group=this.$store.state.userEquipment.userEquipmentGroup}},u=r,c=(s("f431"),s("cba8")),p=Object(c["a"])(u,i,a,!1,null,"8df4ca44",null);t["default"]=p.exports},8279:function(e,t,s){},c1f9:function(e,t,s){"use strict";s.d(t,"a",(function(){return r}));var i=s("b687");function a(e){if(Array.isArray(e))return Object(i["a"])(e)}s("49e9"),s("c2e6"),s("a9b6"),s("742a"),s("2690"),s("d4f9"),s("f4c5");function n(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}var o=s("de83");function l(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function r(e){return a(e)||n(e)||Object(o["a"])(e)||l()}},f431:function(e,t,s){"use strict";s("8279")}}]);
//# sourceMappingURL=chunk-81c54cfa.99ab8768.js.map