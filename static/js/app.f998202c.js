(function(e){function t(t){for(var n,i,s=t[0],l=t[1],c=t[2],d=0,h=[];d<s.length;d++)i=s[d],Object.prototype.hasOwnProperty.call(o,i)&&o[i]&&h.push(o[i][0]),o[i]=0;for(n in l)Object.prototype.hasOwnProperty.call(l,n)&&(e[n]=l[n]);u&&u(t);while(h.length)h.shift()();return r.push.apply(r,c||[]),a()}function a(){for(var e,t=0;t<r.length;t++){for(var a=r[t],n=!0,i=1;i<a.length;i++){var s=a[i];0!==o[s]&&(n=!1)}n&&(r.splice(t--,1),e=l(l.s=a[0]))}return e}var n={},i={app:0},o={app:0},r=[];function s(e){return l.p+"static/js/"+({}[e]||e)+"."+{"chunk-18aa8ace":"967f9af5","chunk-2534d0d6":"ed05148d","chunk-81c54cfa":"99ab8768","chunk-918896dc":"c753ee11"}[e]+".js"}function l(t){if(n[t])return n[t].exports;var a=n[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,l),a.l=!0,a.exports}l.e=function(e){var t=[],a={"chunk-18aa8ace":1,"chunk-2534d0d6":1,"chunk-81c54cfa":1,"chunk-918896dc":1};i[e]?t.push(i[e]):0!==i[e]&&a[e]&&t.push(i[e]=new Promise((function(t,a){for(var n="static/css/"+({}[e]||e)+"."+{"chunk-18aa8ace":"68af7fe4","chunk-2534d0d6":"f30e9c45","chunk-81c54cfa":"b747a712","chunk-918896dc":"a8859e34"}[e]+".css",o=l.p+n,r=document.getElementsByTagName("link"),s=0;s<r.length;s++){var c=r[s],d=c.getAttribute("data-href")||c.getAttribute("href");if("stylesheet"===c.rel&&(d===n||d===o))return t()}var h=document.getElementsByTagName("style");for(s=0;s<h.length;s++){c=h[s],d=c.getAttribute("data-href");if(d===n||d===o)return t()}var u=document.createElement("link");u.rel="stylesheet",u.type="text/css",u.onload=t,u.onerror=function(t){var n=t&&t.target&&t.target.src||o,r=new Error("Loading CSS chunk "+e+" failed.\n("+n+")");r.code="CSS_CHUNK_LOAD_FAILED",r.request=n,delete i[e],u.parentNode.removeChild(u),a(r)},u.href=o;var p=document.getElementsByTagName("head")[0];p.appendChild(u)})).then((function(){i[e]=0})));var n=o[e];if(0!==n)if(n)t.push(n[2]);else{var r=new Promise((function(t,a){n=o[e]=[t,a]}));t.push(n[2]=r);var c,d=document.createElement("script");d.charset="utf-8",d.timeout=120,l.nc&&d.setAttribute("nonce",l.nc),d.src=s(e);var h=new Error;c=function(t){d.onerror=d.onload=null,clearTimeout(u);var a=o[e];if(0!==a){if(a){var n=t&&("load"===t.type?"missing":t.type),i=t&&t.target&&t.target.src;h.message="Loading chunk "+e+" failed.\n("+n+": "+i+")",h.name="ChunkLoadError",h.type=n,h.request=i,a[1](h)}o[e]=void 0}};var u=setTimeout((function(){c({type:"timeout",target:d})}),12e4);d.onerror=d.onload=c,document.head.appendChild(d)}return Promise.all(t)},l.m=e,l.c=n,l.d=function(e,t,a){l.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},l.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},l.t=function(e,t){if(1&t&&(e=l(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(l.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)l.d(a,n,function(t){return e[t]}.bind(null,n));return a},l.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return l.d(t,"a",t),t},l.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},l.p="",l.oe=function(e){throw console.error(e),e};var c=window["webpackJsonp"]=window["webpackJsonp"]||[],d=c.push.bind(c);c.push=t,c=c.slice();for(var h=0;h<c.length;h++)t(c[h]);var u=d;r.push([0,"chunk-vendors"]),a()})({0:function(e,t,a){e.exports=a("56d7")},"0a59":function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_FACTORY__,__WEBPACK_AMD_DEFINE_RESULT__,_objectDestructuringEmpty=__webpack_require__("8782").default,_toConsumableArray=__webpack_require__("0553").default,_objectSpread=__webpack_require__("925d").default,_typeof=__webpack_require__("64a7").default;__webpack_require__("a9d5"),__webpack_require__("a9b6"),__webpack_require__("28fd"),__webpack_require__("16e1"),__webpack_require__("2690"),__webpack_require__("d4f9"),__webpack_require__("e793"),__webpack_require__("a16b"),__webpack_require__("3fab"),__webpack_require__("aaa2"),__webpack_require__("8d1b"),__webpack_require__("c284"),__webpack_require__("6ba1"),__webpack_require__("9d16"),__webpack_require__("0500"),__webpack_require__("3bdf"),__webpack_require__("ed02"),__webpack_require__("44ad"),__webpack_require__("57b6"),__webpack_require__("3e22"),__webpack_require__("59d7"),__webpack_require__("6794"),__webpack_require__("8372"),__webpack_require__("35df"),__webpack_require__("8c44"),__webpack_require__("2f57"),__webpack_require__("05ca"),__webpack_require__("89cf"),__webpack_require__("688d"),__webpack_require__("4fb6"),__webpack_require__("3f27"),function(e,t){"object"===_typeof(exports)&&"undefined"!==typeof module?module.exports=t():(__WEBPACK_AMD_DEFINE_FACTORY__=t,__WEBPACK_AMD_DEFINE_RESULT__="function"===typeof __WEBPACK_AMD_DEFINE_FACTORY__?__WEBPACK_AMD_DEFINE_FACTORY__.call(exports,__webpack_require__,exports,module):__WEBPACK_AMD_DEFINE_FACTORY__,void 0===__WEBPACK_AMD_DEFINE_RESULT__||(module.exports=__WEBPACK_AMD_DEFINE_RESULT__))}(0,(function(){"use strict";console.log("欢迎使用 View2d version: 1.0.0 - 官网：http://***");var View2d={save:save,saveAsImage:saveAsImage,getData:getData,scene:null,Node:null,Group:null,$el:null,$template:null,ctx:null,nodes:[],lock:!1,activeNode:null,pen:{drawPath:!1,color:"#409EFF",showPath:!1,data:null},mode:{type:"edit",center:!0,scaleable:!1,moveable:!0,padding:[0,0],zoom:{max:5,min:.2,rate:1}},color:["#409EFF","#c23531","#E6A23C","#67C23A","#91c7ae","#dddddd","#bda29a","#546570"],baseLine:{color:"orange",lineWidth:1,space:5,x:[],y:[]},checkbox:{show:!1,checkboxGroup:null,start:{x:0,y:0},end:{x:0,y:0},lineWidth:2,color:"#1890ff",background:"rgba(0,50,150,0.2)"},grid:{show:!1,lineWidth:.5,color:"rgba(225,225,225,0.8)",step:{x:30,y:30}},background:{color:"#000",image:""}};function save(e){var t=View2d.nodes.find((function(e){return e.constructor===View2d.scene}));t.scale(t.position,1,1),e=e||"View2d_data_"+Math.round(Math.random()*Math.pow(10,6));var a={baseLine:View2d.baseLine,grid:View2d.grid,background:View2d.background,nodes:View2d.nodes.filter((function(e){return null!=e.zIndex}))};a=JSON.stringify(a,void 0,4);var n=new Blob([a],{type:"text/json"}),i=document.createElement("a");i.href=window.URL.createObjectURL(n),i.download=e+".json",i.click()}function saveAsImage(e){e=e||"View2d_image_"+Math.round(Math.random()*Math.pow(10,6))+".png";var t=e.match(/^(.*)\.(.*)$/),a=t[2]||"png",n=View2d.$el.toDataURL(a),i=document.createElement("a");i.download=e,i.href=n,document.body.appendChild(i),i.click(),i.remove()}function getData(){var e=View2d.nodes.find((function(e){return e.constructor===View2d.scene}));e.scale(e.position,1,1);var t={baseLine:View2d.baseLine,grid:View2d.grid,background:View2d.background,nodes:View2d.nodes.filter((function(e){return null!=e.zIndex}))};return t}var templateMousedown=!1;function drawBackground(){var e=View2d.background.color||"#000",t=View2d.ctx;if(t.fillStyle=e,t.fillRect(0,0,View2d.$el.width,View2d.$el.height),View2d.background.image){var a=new Image;a.src=View2d.background.image,t.drawImage(a,0,0,View2d.$el.width,View2d.$el.height)}}function drawgrid(){var e=View2d.grid,t=e.lineWidth,a=e.color,n=e.step,i=View2d.ctx;i.lineWidth=t,i.strokeStyle=a;for(var o=n.x+t;o<View2d.$el.width;o+=n.x)i.beginPath(),i.moveTo(o,0),i.lineTo(o,View2d.$el.height),i.stroke();for(var r=n.y+t;r<View2d.$el.height;r+=n.y)i.beginPath(),i.moveTo(0,r),i.lineTo(View2d.$el.width,r),i.stroke()}function drawBaseLine(e){var t=View2d.ctx;t.save(),t.strokeStyle=View2d.baseLine.color,t.lineWidth=View2d.baseLine.lineWidth,t.beginPath(),t.moveTo(e[0].x,e[0].y),t.lineTo(e[1].x,e[1].y),t.stroke(),t.restore()}function darwCheckbox(e,t){var a=View2d.ctx;a.save(),a.strokeStyle=View2d.checkbox.color,a.fillStyle=View2d.checkbox.background,a.lineWidth=View2d.checkbox.lineWidth,a.beginPath(),a.rect(e.x,e.y,t.x-e.x,t.y-e.y),a.fill(),a.stroke(),a.restore()}function traverse(e){this.children.forEach((function(t,a){t.constructor==View2d.Group&&t.children.length>0?(t.traverse(e),e(t)):e(t)}))}function drawLine(node,boolean){var ctx=View2d.ctx;ctx.save(),eval(node.shape+"(node, !!boolean)"),ctx.restore()}View2d.scene=function(parentElement){var option=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};parentElement=parentElement||document.body,"string"===typeof parentElement&&(parentElement=document.querySelector(parentElement)),this.scaleVal={x:1,y:1},this.children=[],this.zIndex=null,View2d.nodes=[],eventsList=[],View2d.checkbox.checkboxGroup=new View2d.Group({type:"extraGroup"}),this.width=parentElement.clientWidth,this.height=parentElement.clientHeight,this.position={x:this.width/2,y:this.height/2},View2d.$el=document.createElement("canvas"),View2d.$el.style.display="block",View2d.$el.width=this.width,View2d.$el.height=this.height,parentElement.appendChild(View2d.$el),View2d.ctx=View2d.$el.getContext("2d"),View2d.$template=document.createElement("canvas"),View2d.$template.style.display="none",View2d.$template.width=this.width,View2d.$template.height=this.height,View2d.$template.style.position="absolute",View2d.$template.style.top="0",View2d.$template.style.left="0",View2d.$template.style.zIndex="2020",View2d.$template.style.background="rgba(0,0,0,0.3)",View2d.pen.ctx=View2d.$template.getContext("2d"),parentElement.appendChild(View2d.$template),View2d.$template.addEventListener("mousedown",(function(){if(null!==View2d.pen.data&&1==event.buttons){templateMousedown=!0;var e={x:event.offsetX,y:event.offsetY,type:event.ctrlKey?"curve":"straight"};View2d.pen.data.linePath.push(e)}})),View2d.$template.addEventListener("mousemove",(function(){if(null!==View2d.pen.data){var e={x:event.offsetX,y:event.offsetY,type:event.ctrlKey?"curve":"straight"};View2d.pen.data.linePath.push(e),View2d.pen.data.linePath.length>1&&View2d.pen.data.linePath.splice(View2d.pen.data.linePath.length-2,1)}null!==View2d.pen.data&&(View2d.$template.style.display="block")}));var that=this;View2d.$template.addEventListener("contextmenu",(function(){if(event.preventDefault(),event.stopPropagation(),View2d.$template.style.display="none",templateMousedown&&View2d.pen.data.linePath.length>2){if("waterCapacity"==View2d.pen.data.shape&&View2d.pen.data.linePath.length<=3)return!1;View2d.pen.data.linePath.pop();var e=new View2d.Line(_objectSpread({},View2d.pen.data));that.add(e),templateMousedown=!1}View2d.pen.data=null})),View2d.$el.addEventListener("mousemove",(function(){null!==View2d.pen.data?View2d.$template.style.display="block":View2d.$template.style.display="none"})),View2d.$dom=document.createElement("div"),View2d.$dom.style.width=this.width+"px",View2d.$dom.style.height=this.height+"px",View2d.$dom.style.position="absolute",View2d.$dom.style.top="0",View2d.$dom.style.left="0",View2d.$dom.style.overflow="hidden",View2d.$dom.style.pointerEvents="none",parentElement.appendChild(View2d.$dom);var _this=this;if(this.add=function(e){if(void 0===e.vertex)return!1;e.parentId=void 0,e.zIndex=e.zIndex||_this.children.length,_this.children.push(e),e.constructor===View2d.Line&&drawLine(e,!0),e.constructor==View2d.Node&&drawNode(e,!0),e.constructor==View2d.Group&&e.traverse((function(e){e.constructor===View2d.Node&&drawNode(e,!0),e.constructor===View2d.Line&&drawLine(e,!0),"drawEcharts"==e.shape&&View2d.$dom.appendChild(e.element)})),View2d.lock||(e.dragEvents=[],e.on("drag"))},this.remove=function(e){_this.children.forEach((function(t,a){t.ID==e.ID&&(_this.children.splice(a,1),"drawEcharts"==t.shape&&View2d.$dom.removeChild(t.element),t.constructor==View2d.Group&&t.traverse((function(e){"drawEcharts"==e.shape&&View2d.$dom.removeChild(e.element)})))})),View2d.nodes.forEach((function(t,a){t.ID==e.ID&&(View2d.nodes[a].zIndex=null)})),View2d.activeNode=null},this.getRectArea=function(){var e=[],t=[];this.traverse((function(a){"line"==a.type?a.linePath.forEach((function(a){e.push(a.x),t.push(a.y)})):(e.push(a.vertex[0].x,a.vertex[1].x,a.vertex[2].x,a.vertex[3].x),t.push(a.vertex[0].y,a.vertex[1].y,a.vertex[2].y,a.vertex[3].y))}));var a=Math.min.apply(Math,e),n=Math.max.apply(Math,e),i=Math.min.apply(Math,t),o=Math.max.apply(Math,t),r=[{x:a,y:i},{x:n,y:i},{x:n,y:o},{x:a,y:o}];return r},this.resize=function(){_this.width=View2d.$el.parentElement.clientWidth,_this.height=View2d.$el.parentElement.clientHeight,View2d.$el.width=_this.width,View2d.$el.height=_this.height,View2d.$template.width=_this.width,View2d.$template.height=_this.height,View2d.$dom.style.width=_this.width+"px",View2d.$dom.style.height=_this.height+"px";var e=_this.getRectArea(),t=Math.round(e[1].x-e[0].x),a=Math.round(e[2].y-e[0].y),n=t/(_this.width-View2d.mode.padding[0])/_this.scaleVal.x,i=a/(_this.height-View2d.mode.padding[1])/_this.scaleVal.y,o={x:e[0].x+t/2,y:e[0].y+a/2},r={xl:_this.width/2-o.x,yl:_this.height/2-o.y};_this.traverse((function(e){"line"!==e.type?(e.position.x+=r.xl,e.position.y+=r.yl,e.vertex.forEach((function(t,a){e.vertex[a].x+=r.xl,e.vertex[a].y+=r.yl}))):e.linePath.forEach((function(t,a){e.linePath[a].x+=r.xl,e.linePath[a].y+=r.yl}))}));var s=Math.max(n,i);_this.scale({x:_this.width/2,y:_this.height/2},1/s,1/s)},this.update=function(){null!==View2d.pen.data&&View2d.pen.ctx.clearRect(0,0,_this.width,_this.height);var e=View2d.ctx;e.clearRect(0,0,_this.width,_this.height),_this.width=View2d.$el.parentElement.clientWidth,_this.height=View2d.$el.parentElement.clientHeight,View2d.$el.width=_this.width,View2d.$el.height=_this.height,View2d.$template.width=_this.width,View2d.$template.height=_this.height,View2d.$dom.style.width=_this.width+"px",View2d.$dom.style.height=_this.height+"px",drawBackground(),View2d.grid.show&&drawgrid(),this.children.sort((function(e,t){return e.zIndex-t.zIndex})),this.children.forEach((function(t){e.strokeStyle="#000",e.save(),t.constructor===View2d.Line&&drawLine(t,!0),t.constructor===View2d.Node&&drawNode(t,!0),t.constructor===View2d.Group&&t.traverse((function(e){e.constructor===View2d.Node?drawNode(e,!0):e.constructor===View2d.Line&&drawLine(e,!0)})),e.restore(),t.helperBox&&setHeperBox(t),t.freeze&&"edit"==View2d.mode.type&&setFreezeBk(t)})),View2d.baseLine.x.length>0&&drawBaseLine(View2d.baseLine.x),View2d.baseLine.y.length>0&&drawBaseLine(View2d.baseLine.y),View2d.checkbox.show&&darwCheckbox(View2d.checkbox.start,View2d.checkbox.end),null!==View2d.pen.data&&darwLinePath()},this.scale=function(e,t,a){var n=this,i=t/this.scaleVal.x,o=a/this.scaleVal.y;this.position=_objectSpread({},e),this.traverse((function(e){if("line"!==e.type){var t=accountNodeScale(e,i,o);setVertexVal(t,e);var a={x:e.position.x-n.position.x,y:e.position.y-n.position.y},r=getRotatePos(a,{x:0,y:0},-t.rotateVal*Math.PI/180);r.x*=i,r.y*=o,a=getRotatePos(r,{x:0,y:0},t.rotateVal*Math.PI/180),resizeEchart(e);var s={x:n.position.x+a.x,y:n.position.y+a.y},l={xl:s.x-e.position.x,yl:s.y-e.position.y};e.vertex.forEach((function(t,a){e.vertex[a].x+=l.xl,e.vertex[a].y+=l.yl})),e.position=s}else e.linePath.forEach((function(t,a){var r={xl:n.position.x-t.x,yl:n.position.y-t.y};e.linePath[a].x+=r.xl*(1-i),e.linePath[a].y+=r.yl*(1-o)}))})),_this.scaleVal={x:t,y:a}},this.traverse=traverse,View2d.nodes.push(this),View2d.$el.attachEvent&&View2d.$el.attachEvent("onmousewheel",scrollScale),View2d.$el.addEventListener&&View2d.$el.addEventListener("DOMMouseScroll",scrollScale,!1),View2d.$el.onmousewheel=View2d.$el.onmousewheel=scrollScale,Object.keys(option).length>0){option.nodes=option.nodes.sort((function(e,t){return e.zIndex-t.zIndex}));var g=this;View2d.activeNode=null,option.nodes.forEach((function(item){if(null!==item.zIndex){var node=null;if("extraGroup"==item.type)item.children.forEach((function(e){"preview"==View2d.mode.type&&(e.rotateVal+=item.rotateVal,e.scaleVal.x+=e.scaleVal.x*(item.scaleVal.x-1),e.scaleVal.y+=e.scaleVal.y*(item.scaleVal.y-1)),void 0==e.children?(node="node"==e.type?new View2d.Node(e):new View2d.Line(e),resizeEchart(node),node.events.forEach((function(e){e.isDrag||"drag"===e.events||node.on(e.events,e.callBack,e.callBack1,e.callBack2)}))):(node=new View2d.Group(e),node=setToNode(node)),node.helperBox=!1,node.zIndex=null,g.add(node)}));else{if(void 0==item.children){node="node"==item.type?new View2d.Node(item):new View2d.Line(item),resizeEchart(node);var _events=[];node.events.forEach((function(item){item.isDrag||"drag"===item.events||(node.on(item.events,(function(){eval(item.params.value)})),_events.push(item))})),node.events=_events}else node=new View2d.Group(item),node=setToNode(node),node.events.forEach((function(item){item.isDrag||"drag"===item.events||(node.on(item.events,(function(){eval(item.params.value)})),events.push(item))})),node.events=events;node.helperBox=!1,node.zIndex=null,g.add(node)}}})),this.resize(),View2d.baseLine=option.baseLine,View2d.background=option.background,View2d.grid=option.grid}};var allRotate=0,allScale={x:1,y:1};function drawNode(node,boolean){var ctx=View2d.ctx;ctx.save(),ctx.lineWidth=node.lineWidth||1,ctx.shadowOffsetX=node.shadowOffsetX||0,ctx.shadowOffsetY=node.shadowOffsetY||0,ctx.shadowColor=node.shadowColor||"orange",ctx.shadowBlur=node.shadowBlur||0,allRotate=0;var scene=View2d.nodes.find((function(e){return e.constructor===View2d.scene}));allScale=_objectSpread({},scene.scaleVal),parentTransform.call(node);var parent=node.findParent();if(ctx.setTransform(Math.cos(allRotate),Math.sin(allRotate),-Math.sin(allRotate),Math.cos(allRotate),node.position.x,node.position.y),ctx.scale(allScale.x,allScale.y),node.allScale=allScale,node.allRotate=allRotate,"function"===typeof node.createNode){var str=node.createNode.toString(),reg=/\/\/(?=ctx.fill\(\)|ctx.stroke\(\))/g,nodeFunc=str.replace(reg,"");node.createNode=new Function("return "+nodeFunc)(),node.createNode({ctx:ctx,node:node,x:node.originPosition.x,y:node.originPosition.y})}else eval(node.shape+"(node, !!boolean)");ctx.scale(1/allScale.x,1/allScale.y),autoText(node,scene),ctx.restore()}function parentTransform(){var e=this;if(void 0!==this.parentId){var t=View2d.nodes.find((function(t){return t.ID==e.parentId}));parentTransform.call(t)}allRotate+=this.rotateVal*Math.PI/180,allScale={x:this.scaleVal.x*allScale.x,y:this.scaleVal.y*allScale.y}}function autoText(e,t){var a=View2d.ctx;a.textBaseline="middle";var n={x:1,y:1};n.x=t.scaleVal.x,n.y=t.scaleVal.y,a.scale(n.x,n.y);var i=e.text,o=i.color,r=i.fontSize,s=i.fontFamily,l=i.lineHeight,c=i.fontWeight,d=i.fontStyle,h=i.textAlign,u=i.textVertical,p=i.padding,f=i.textShadowOffsetX,m=i.textShadowOffsetY,v=i.textShadowColor,x=i.textShadowBlur;a.fillStyle=o,a.font="".concat(d," ").concat(c," ").concat(r,"px ").concat(s),a.shadowOffsetX=f,a.shadowOffsetY=m,a.shadowColor=v,a.shadowBlur=x;var w=e.vertex[0].x-e.vertex[1].x,_=e.vertex[0].y-e.vertex[1].y,y=Math.sqrt(w*w+_*_)-2*p[1]*n.x,b=e.vertex[1].x-e.vertex[2].x,g=e.vertex[1].y-e.vertex[2].y,V=Math.sqrt(b*b+g*g)-2*p[0]*n.x,k=0,P=e.text.content||"",S=a.measureText(P).width*n.x,C=Math.ceil(S/y),I=C>1?0:(y-S)/2,N=(V-C*l*n.x)/2;switch(u){case"top":N=0;break;case"bottom":N=0,V=-V+C*l*n.x*2+l*n.x;break}switch(h){case"left":I=0;break;case"right":I=C>1?0:y-S;break}var E=-y/2+I,T=-V/2+N+l*n.x/2;a.beginPath();for(var M=0;M<P.length;M++){var D=a.measureText(P[M]).width*n.x;k+D>=y&&(k=0,T+=l*n.x,E=a.measureText(P.slice(M)).width*n.x<y&&"left"!==h?"center"==h?-a.measureText(P.slice(M)).width*n.x/2:y/2-a.measureText(P.slice(M)).width*n.x:-y/2),a.fillText(P[M],E/n.x,T/n.x),E+=D,k+=D}}function setHeperBox(e){var t=View2d.ctx;if("line"!==e.type){var a=e.findParent();t.save(),t.lineWidth=2,t.beginPath(),t.strokeStyle=e.freeze?"#ccc":"#2cafe7",t.fillStyle="#fff",e.vertex.forEach((function(e,n){t.save(),t.translate(e.x,e.y),t.rotate(a.rotateVal*Math.PI/180),t.lineTo(0,0),t.restore()})),t.closePath(),t.stroke();var n={x:e.vertex[0].x+(e.vertex[1].x-e.vertex[0].x)/2,y:e.vertex[0].y+(e.vertex[1].y-e.vertex[0].y)/2};t.strokeStyle=e.freeze?"#ccc":"#2cafe7",t.fillStyle="#fff",t.beginPath(),t.moveTo(n.x,n.y),t.lineTo(n.x+50*Math.sin(e.rotateVal*Math.PI/180),n.y-50*Math.cos(e.rotateVal*Math.PI/180)),t.stroke(),t.beginPath(),t.arc(n.x+50*Math.sin(e.rotateVal*Math.PI/180),n.y-50*Math.cos(e.rotateVal*Math.PI/180),6,0,2*Math.PI),t.stroke(),t.fill(),t.beginPath(),t.strokeStyle=e.freeze?"#ccc":"#2cafe7",t.fillStyle="#fff",e.vertex.forEach((function(n,i){var o,r;t.save(),t.translate(n.x,n.y),t.rotate(a.rotateVal*Math.PI/180),t.lineTo(0,0),t.strokeRect(-5,-5,10,10),t.fillRect(-5,-5,10,10),t.restore(),t.save(),i!==e.vertex.length-1?(o=e.vertex[i].x-(e.vertex[i].x-e.vertex[i+1].x)/2,r=e.vertex[i].y-(e.vertex[i].y-e.vertex[i+1].y)/2):(o=e.vertex[i].x-(e.vertex[i].x-e.vertex[0].x)/2,r=e.vertex[i].y-(e.vertex[i].y-e.vertex[0].y)/2),t.translate(o,r),t.rotate(a.rotateVal*Math.PI/180),t.strokeRect(-5,-5,10,10),t.fillRect(-5,-5,10,10),t.restore()})),t.restore(),e.constructor===View2d.Group&&e.traverse((function(a){t.lineWidth=1,t.strokeStyle=e.freeze?"#ccc":"#2cafe7",t.beginPath(),a.vertex.forEach((function(e){t.lineTo(e.x,e.y)})),t.closePath(),t.stroke()}))}else t.save(),e.linePath.forEach((function(a,n){var i={x:a.x,y:a.y};if(void 0!==a.id){var o=getNodeById(a.id);void 0!==o?i=o.position:e.linePath[n].id=void 0,e.linePath[n].x=i.x,e.linePath[n].y=i.y}e.helperBox&&(t.fillStyle=e.freeze?"#ccc":"orange",t.beginPath(),t.arc(i.x,i.y,5,0,2*Math.PI),t.fill())})),t.restore()}function getNodeById(e){return View2d.nodes.find((function(t){return t.ID==e}))}function darwLinePath(){var ctx=View2d.pen.ctx,data=View2d.pen.data;ctx.save(),ctx.lineWidth=data.lineWidth||1,eval(data.shape+"(data, true, ctx)"),ctx.restore(),ctx.strokeStyle=View2d.pen.color||"#fff",ctx.lineWidth=View2d.pen.lineWidth||1,(View2d.pen.showPath||"waterCapacity"==data.shape)&&(ctx.save(),ctx.beginPath(),_darwlinePath(data.linePath,ctx),ctx.restore(),ctx.stroke())}function setFreezeBk(e){var t=View2d.ctx;t.save(),t.strokeStyle="#ccc",t.beginPath(),t.fillStyle="rgba(10,10,25,0.5)",e.vertex.forEach((function(e){t.lineTo(e.x,e.y)})),t.closePath(),t.stroke(),t.fill(),t.restore()}View2d.Line=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};for(var a in t.color="undefined"==typeof t.color?View2d.color:t.color,t.color=_toConsumableArray(t.color),this.type="line",this.name="line"+View2d.nodes.length+1,this.zIndex=null,this.vertex=[],this.events=[],this.helperBox=!1,this.dragEvents=[],this.rotateVal=0,this.scaleVal={x:1,y:1},this.linePath=[],this.color="undefined"==typeof t.color?View2d.color:t.color,this.color=_toConsumableArray(this.color),t.linePath.forEach((function(t){e.linePath.push(_objectSpread({},t))})),t)this[a]=this[a]||t[a];this.ID=this.ID||uuid(),View2d.nodes.push(this)},View2d.Line.prototype.findParent=findParent,View2d.Line.prototype.clone=clone,View2d.Line.prototype.checkPointInPath=checkPointInPath,View2d.Line.prototype.on=setEvents,View2d.Line.prototype.off=offEvents,View2d.Line.prototype.offAll=offAllEvents,View2d.Group=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(void 0!==e.vertex){for(var t in e=deepClone(e),e)this[t]=e[t];return this.name="group"+View2d.nodes.length+1,this.ID=this.ID||uuid(),View2d.nodes.push(this),!1}if(this.type="group",this.freeze=!1,this.children=[],this.events=[],this.dragEvents=[],this.helperBox=!1,this.zIndex=null,this.rotateVal=0,this.scaleVal={x:1,y:1},this.groupPosition={x:0,y:0},this.originPosition={x:0,y:0},this.position={x:0,y:0},this.DValue={x:0,y:0},this.name=e.name||"group"+View2d.nodes.length+1,Object.keys(e).length>0)for(var a in this.originPosition=_objectSpread({},e.position),this.position=_objectSpread({},e.position),e)this[a]=e[a];this.ID=this.ID||uuid(),View2d.nodes.push(this)},View2d.Group.prototype.add=function(){var e=this,t=arguments;this.scaleVal={x:1,y:1},this.rotateVal=0,this.children.forEach((function(t){t.rotateVal+=e.rotateVal,t.scaleVal.x+=(e.scaleVal.x-1)*t.scaleVal.x,t.scaleVal.y+=(e.scaleVal.y-1)*t.scaleVal.y}));var a=View2d.nodes.find((function(e){return e.constructor===View2d.scene})),n=[],i=[];void 0!==this.vertex&&(n=[this.vertex[0].x,this.vertex[1].x],i=[this.vertex[0].y,this.vertex[2].y]);var o=function(o){var r,s,l,c;(a.children.forEach((function(e){e.ID===t[o].ID&&(a.remove(e),"drawEcharts"==e.shape&&View2d.$dom.appendChild(e.element))})),e.children.push(t[o]),t[o].parentId=e.ID,t[o].constructor===View2d.Group)?t[o].traverse((function(e){var t,a;e.constructor===View2d.Node&&((t=n).push.apply(t,_toConsumableArray(e.vertex.map((function(e){return e.x})))),(a=i).push.apply(a,_toConsumableArray(e.vertex.map((function(e){return e.y})))))})):"line"!==t[o].type?((r=n).push.apply(r,_toConsumableArray(t[o].vertex.map((function(e){return e.x})))),(s=i).push.apply(s,_toConsumableArray(t[o].vertex.map((function(e){return e.y}))))):((l=n).push.apply(l,_toConsumableArray(t[o].linePath.map((function(e){return e.x})))),(c=i).push.apply(c,_toConsumableArray(t[o].linePath.map((function(e){return e.y})))))};for(var r in arguments)o(r);var s=Math.min.apply(Math,_toConsumableArray(n)),l=Math.max.apply(Math,_toConsumableArray(n)),c=Math.min.apply(Math,_toConsumableArray(i)),d=Math.max.apply(Math,_toConsumableArray(i));this.vertex=[{x:s,y:c},{x:l,y:c},{x:l,y:d},{x:s,y:d}];var h={x:s+(l-s)/2,y:c+(d-c)/2};this.position=_objectSpread({},h),this.originPosition=_objectSpread({},h);var u=this.findParent();h=_objectSpread({},u.position),this.children.forEach((function(t){t.groupPosition={x:t.position.x-e.position.x,y:t.position.y-e.position.y}}))},View2d.Group.prototype.remove=function(){var e=arguments,t=this,a=[],n=[],i=[];this.children.forEach((function(a,n){var o=!1;for(var r in e)a.ID==e[r].ID&&(a.rotateVal+=t.rotateVal,a.scaleVal.x+=(t.scaleVal.x-1)*a.scaleVal.x,a.scaleVal.y+=(t.scaleVal.y-1)*a.scaleVal.y,e[r].groupPosition={x:0,y:0},e[r].zIndex=null,e[r].parentId=void 0,o=!0);o||i.push(a)})),this.children=i,this.traverse((function(e){e.vertex.forEach((function(e){a.push(e.x),n.push(e.y)}))}));var o=Math.min.apply(Math,a),r=Math.max.apply(Math,a),s=Math.min.apply(Math,n),l=Math.max.apply(Math,n);this.vertex=[{x:o,y:s},{x:r,y:s},{x:r,y:l},{x:o,y:l}];var c={x:o+(r-o)/2,y:s+(l-s)/2};this.position=_objectSpread({},c),this.traverse((function(e){"line"!==e.type&&(e.rotateVal+=t.rotateVal,e.scaleVal.x+=(t.scaleVal.x-1)*e.scaleVal.x,e.scaleVal.y+=(t.scaleVal.y-1)*e.scaleVal.y,e.groupPosition={x:e.position.x-t.position.x,y:e.position.y-t.position.y})})),this.scaleVal={x:1,y:1},this.rotateVal=0},View2d.Group.prototype.combine=function(){if("extraGroup"==this.type){var e=View2d.nodes.find((function(e){return e.constructor==View2d.scene})),t=this.children;this.children=[];var a=this.clone();t.forEach((function(e){e.parentId=a.ID})),a.children=t.sort((function(e,t){return e.zIndex-t.zIndex})),a.type="group",e.remove(this),e.add(a),View2d.activeNode=a}},View2d.Group.prototype.unCombine=function(){var e=this,t=View2d.nodes.find((function(e){return e.constructor==View2d.scene}));this.children.forEach((function(a){t.remove(e),"line"!==a.type&&(a.rotateVal+=e.rotateVal,a.scaleVal.x+=a.scaleVal.x*(e.scaleVal.x-1),a.scaleVal.y+=a.scaleVal.y*(e.scaleVal.y-1)),"group"===a.type&&(a.groupPosition={x:0,y:0}),"drawEcharts"==a.shape&&View2d.$dom.appendChild(a.element),a.constructor==View2d.Group&&a.traverse((function(e){"drawEcharts"==e.shape&&View2d.$dom.appendChild(e.element)})),t.add(a)})),this.children=[]},View2d.Group.prototype.findParent=findParent,View2d.Group.prototype.accountVertex=accountVertex,View2d.Group.prototype.translate=translate,View2d.Group.prototype.rotate=rotate,View2d.Group.prototype.clone=clone,View2d.Group.prototype.checkPointInPath=checkPointInPath,View2d.Group.prototype.traverse=traverse,View2d.Group.prototype.on=setEvents,View2d.Group.prototype.scale=scale,View2d.Group.prototype.off=offEvents,View2d.Group.prototype.offAll=offAllEvents;var eventsList=[],hasSetEvent=[],dragStartOffset={},dragNodeZIndex=null,isDrag=!1;function textDefault(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t={};return t.content=e.content||"",t.color=e.color||"#fff",t.fontSize=e.fontSize||20,t.fontFamily=e.fontFamily||"Sans-serif",t.lineHeight=e.lineHeight||t.fontSize+5,t.fontWeight=e.fontWeight||"normal",t.fontStyle=e.fontStyle||"normal",t.textAlign=e.textAlign||"center",t.textVertical=e.textVertical||"center",t.padding=e.padding||[0,0],t.shadowOffsetX=e.textShadowOffsetX||0,t.shadowOffsetY=e.textShadowOffsetY||0,t.shadowColor=e.textShadowColor||"orange",t.shadowBlur=e.textShadowBlur||0,t}function borderDefault(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t={};return t.show=e.show||!1,t.color=e.color||"#ccc",t.lineWidth=e.lineWidth||1,t.lineCap=e.lineCap||"square",t.lineJoin=e.lineJoin||"round",t.lineDash=e.lineDash||[0,0],t}function accountVertex(){this.params=this.params||{w:500,h:500};this.params.w||this.params.r,this.params.h||this.params.r;View2d.nodes.push(this);for(var e=0,t=0,a=9999,n=9999,i=0;i<=View2d.$el.width;i+=1)for(var o=0;o<=View2d.$el.height;o+=1)View2d.ctx.isPointInPath(i,o)&&(e=e>i?e:i,t=t>o?t:o,a=a<i?a:i,n=n<o?n:o);var r={x:a+(e-a)/2,y:n+(t-n)/2};0==Object.keys(this.position).length||void 0==this.parentId?this.vertex=[{x:a,y:n},{x:e,y:n},{x:e,y:t},{x:a,y:t}]:(this.groupPosition={x:this.position.x-r.x,y:this.position.y-r.y},this.vertex=[{x:a+this.groupPosition.x,y:n+this.groupPosition.y},{x:e+this.groupPosition.x,y:n+this.groupPosition.y},{x:e+this.groupPosition.x,y:t+this.groupPosition.y},{x:a+this.groupPosition.x,y:t+this.groupPosition.y}]);var s=View2d.nodes.find((function(e){return e.constructor===View2d.scene}));this.scale(s.scaleVal.x,s.scaleVal.y),this.scaleVal={x:1,y:1}}function handleElement(e,t){if("drawEcharts"==e.shape){var a=document.createElement("div");a.style.width=e.params.w+"px",a.style.height=e.params.h+"px",a.style.position="absolute",a.style.zIndex=999,a.style.display="preview"==View2d.mode.type?"block":"none",t.element=a,View2d.$dom.appendChild(a);var n=echarts.init(a);e.echartsOption.color=e.echartsOption.color||View2d.color,n.setOption(e.echartsOption,!0),setTimeout((function(){var e=n.getDataURL(),a=new Image;a.src=e,t.canvasImg=a}),500)}if("drawVideo"==e.shape){var i=document.createElement("video");i.autoplay=t.autoplay=e.autoplay,i.src=t.src=e.src,i.onerror=function(){t.src=!1},t.element=i}if("drawImage"==e.shape){var o=new Image;o.src=t.src=e.src,o.setAttribute("crossOrigin","anonymous"),t.element=o}if("dom"==e.shape){var r=document.createElement("div");r.style.width=e.params.w+"px",r.style.height=e.params.h+"px",r.style.position="absolute",r.style.zIndex=999,t.element=r,View2d.$dom.appendChild(r)}}function findParent(){var e=this,t={};if(void 0!==this.parentId){var a=View2d.nodes.find((function(t){return t.ID==e.parentId}));t=a.findParent()}else t=this;return t}function uuid(){for(var e=[],t="0123456789abcdef",a=0;a<32;a++)e[a]=t.substr(Math.floor(16*Math.random()),1);e[14]="4",e[19]=t.substr(3&e[19]|8,1),e[8]=e[13]=e[18]=e[23]="-";var n=e.join("");return n}function accountNodeScale(e,t,a){nodeRotateVal=0,nodeRotate.call(e);var n=180*nodeRotateVal/Math.PI,i=e.vertex,o=i[0].x-i[1].x,r=i[0].y-i[1].y,s=Math.sqrt(o*o+r*r)/2,l=i[1].x-i[2].x,c=i[1].y-i[2].y,d=Math.sqrt(l*l+c*c)/2,h=s*(t-1),u=d*(a-1),p=Math.cos(n*Math.PI/180)*h,f=Math.sin(n*Math.PI/180)*h,m=Math.sin(n*Math.PI/180)*u,v=Math.cos(n*Math.PI/180)*u;return{dx:p,dx1:m,dy:f,dy1:v,rotateVal:n}}View2d.Node=function(data){if(void 0!==data.linePath&&data.linePath.length<2)return data.color="undefined"==typeof data.color?View2d.color:data.color,data.color=_toConsumableArray(data.color),View2d.pen.data=data,!1;if(void 0!==data.vertex){for(var k in data=deepClone(data),data)data.hasOwnProperty(k)&&void 0!==data[k]&&(this[k]=data[k]);return handleElement(data,this),this.helperBox=!1,this.name="node"+View2d.nodes.length+1,this.ID=this.ID||uuid(),View2d.nodes.push(this),!1}this.events=[],this.dragEvents=[],this.type="node",this.rotateVal=data.rotateVal||0,this.scaleVal={x:1,y:1},this.createNode=null,this.freeze=!1,this.originPosition=_objectSpread({},data.position),this.color="undefined"==typeof data.color?View2d.color:data.color,this.color=_toConsumableArray(this.color),this.text=textDefault(data.text),this.shadowOffsetX=data.shadowOffsetX||0,this.shadowOffsetY=data.shadowOffsetY||0,this.shadowColor=data.shadowColor||"orange",this.shadowBlur=data.shadowBlur||0,this.border=borderDefault(data.border),void 0==data.position&&(this.originPosition={x:0,y:0}),this.position=_objectSpread({},data.position),this.name=data.name||"node"+View2d.nodes.length+1,this.ID=this.ID||uuid(),this.zIndex=null,this.helperBox=!1,this.vertex=[],this.groupPosition=data.groupPosition||{x:0,y:0},this.DValue={x:0,y:0};var ctx=View2d.ctx;if(ctx.save(),ctx.translate(this.position.x,this.position.y),ctx.rotate(this.rotateVal*Math.PI/180),ctx.scale(this.scaleVal.x,this.scaleVal.y),handleElement(data,this),"function"!==typeof data&&"function"!==typeof data.createNode){for(var _k2 in this.drawType=data.drawType||"fill",this.lineWidth=data.lineWidth||1,data)this[_k2]=this[_k2]||data[_k2];eval(data["shape"]+"(this, true)"),this.accountVertex(),ctx.restore()}else{ctx.restore();var reg=/(?=ctx.stroke\(\)|ctx.fill\(\))/g,reg1=/(?=\/\/ctx.stroke\(\)|\/\/ctx.fill\(\))/g,nodeFunc=null;if("function"==typeof data)nodeFunc=data.toString();else{for(var _k3 in nodeFunc=data.createNode.toString(),data)this[_k3]=data[_k3];View2d.nodes.push(this)}nodeFunc=nodeFunc.replace(reg,"//"),nodeFunc=nodeFunc.replace(reg1,"this.accountVertex();"),this.createNode=new Function("return "+nodeFunc)(),this.createNode({ctx:ctx,node:this,x:0,y:0}),nodeFunc=nodeFunc.replace(/this.accountVertex\(\);/g,""),this.createNode=new Function("return "+nodeFunc)()}},View2d.Node.prototype.accountVertex=accountVertex,View2d.Node.prototype.translate=translate,View2d.Node.prototype.rotate=rotate,View2d.Node.prototype.scale=scale,View2d.Node.prototype.clone=clone,View2d.Node.prototype.findParent=findParent,View2d.Node.prototype.checkPointInPath=checkPointInPath,View2d.Node.prototype.linearGradient=linearGradient,View2d.Node.prototype.radialGradient=radialGradient,View2d.Node.prototype.on=setEvents,View2d.Node.prototype.off=offEvents,View2d.Node.prototype.offAll=offAllEvents;var nodeRotateVal=0;function nodeRotate(){var e=this;if(void 0!==this.parentId){var t=View2d.nodes.find((function(t){return t.ID==e.parentId}));nodeRotate.call(t)}nodeRotateVal+=this.rotateVal*Math.PI/180}function setVertexVal(e,t){var a=e.dx,n=e.dx1,i=e.dy,o=e.dy1;t.vertex[0].x+=-a+n,t.vertex[0].y+=-i-o,t.vertex[3].x+=-a-n,t.vertex[3].y+=-i+o,t.vertex[1].x+=a+n,t.vertex[1].y+=i-o,t.vertex[2].x+=a-n,t.vertex[2].y+=i+o}function scale(e,t){var a=this;e=Number(e.toFixed(2)),t=Number(t.toFixed(2));var n=e/this.scaleVal.x,i=t/this.scaleVal.y,o=accountNodeScale(this,n,i);setVertexVal(o,this),this.constructor==View2d.Group&&this.traverse((function(e){if("line"!==e.type){var t=accountNodeScale(e,n,i);setVertexVal(t,e);var o=View2d.nodes.find((function(t){return t.ID==e.parentId})),r=getRotatePos(e.groupPosition,{x:0,y:0},-t.rotateVal*Math.PI/180);r.x*=n,r.y*=i,e.groupPosition=getRotatePos(r,{x:0,y:0},t.rotateVal*Math.PI/180),e.translate({x:o.position.x+e.groupPosition.x,y:o.position.y+e.groupPosition.y}),resizeEchart(e)}else nodeRotateVal=0,nodeRotate.call(e),e.linePath.forEach((function(t,o){var r=getRotatePos(t,a.position,-nodeRotateVal),s={xl:a.position.x-r.x,yl:a.position.y-r.y};r.x+=s.xl*(1-n),r.y+=s.yl*(1-i),e.linePath[o]=_objectSpread({type:t.type,id:t.id},getRotatePos(r,a.position,nodeRotateVal))})),nodeRotateVal=0})),this.scaleVal={x:e,y:t},resizeEchart(this)}function resizeEchart(e){e.echartsOption&&setTimeout((function(){var t=echarts.init(e.element);t.resize()}),50)}var rotateTimer=null;function rotate(e){var t=this;rotateTimer||(rotateTimer=setTimeout((function(){var a=t.position.x,n=t.position.y,i=(e-t.rotateVal)*Math.PI/180;t.rotateVal=e,t.vertex.forEach((function(e,o){var r=(e.x-a)*Math.cos(i)-(e.y-n)*Math.sin(i)+a,s=(e.x-a)*Math.sin(i)+(e.y-n)*Math.cos(i)+n;t.vertex[o]={x:r,y:s}})),t.constructor==View2d.Group&&t.traverse((function(e){if("line"!==e.type){var o=[],r=[];e.vertex.forEach((function(t,s){var l=(t.x-a)*Math.cos(i)-(t.y-n)*Math.sin(i)+a,c=(t.x-a)*Math.sin(i)+(t.y-n)*Math.cos(i)+n;e.vertex[s]={x:l,y:c},o.push(l),r.push(c)}));var s=Math.min.apply(Math,o),l=Math.max.apply(Math,o),c=Math.min.apply(Math,r),d=Math.max.apply(Math,r);e.position={x:s+(l-s)/2,y:c+(d-c)/2},e.groupPosition=getRotatePos(e.groupPosition,{x:0,y:0},i)}else e.linePath.forEach((function(a,n){e.linePath[n]=_objectSpread({type:a.type,id:a.id},getRotatePos(a,t.position,i))}))})),rotateTimer=null}),30))}function translate(e){var t=this,a={xl:e.x-this.position.x,yl:e.y-this.position.y};this.vertex.forEach((function(e,n){t.vertex[n].x+=a.xl,t.vertex[n].y+=a.yl})),this.position.x=e.x,this.position.y=e.y,this.constructor==View2d.Group&&this.traverse((function(e){"line"!==e.type?(e.position.x+=a.xl,e.position.y+=a.yl,e.vertex.forEach((function(t,n){e.vertex[n].x+=a.xl,e.vertex[n].y+=a.yl}))):e.linePath.forEach((function(t,n){e.linePath[n].x+=a.xl,e.linePath[n].y+=a.yl}))}))}function clone(){var e={};return e=deepClone(this),e.zIndex=null,e.ID=uuid(),void 0===e.children?e="node"==e.type?new View2d.Node(e):new View2d.Line(e):(e=new View2d.Group(e),e=setToNode(e)),e}function deepClone(e){var t=null;if(e instanceof Object&&"function"!==typeof e&&e.constructor!==RegExp){for(var a in t=Array.isArray(e)?[]:{},e)"element"!==a&&"color"!==a&&"canvasImg"!==a?(e instanceof Array||e.hasOwnProperty(a))&&(t[a]=deepClone(e[a])):t[a]=e[a];return t}return e}function setToNode(e){return e.children.forEach((function(t,a){if(t.parentId=e.ID,t.ID=uuid(),void 0==t.children)return"node"==t.type?e.children[a]=new View2d.Node(t):e.children[a]=new View2d.Line(t),e;e.children[a]=new View2d.Group(t),e.children[a]=setToNode(e.children[a])})),e}function offEvents(events){var _this13=this,eventTypesList=this.events.map((function(e){return e.events}));eventTypesList.indexOf(events)>-1&&this.events.split(eventTypesList.indexOf(events),1),eventsList=eventsList.filter((function(e){return"drag"===events?_this13.ID!==e.node.ID&&!(_this13.ID==e.node.ID&&e.isDrag):!(_this13.ID==e.node.ID&&e.events===events)})),"hover"!==events&&"drag"!==events?(View2d.$el.removeEventListener(events,eval(events+"Fun")),View2d.$el.addEventListener(events,eval(events+"Fun"))):(View2d.$el.removeEventListener("mousemove",eval(events+"Fun")),View2d.$el.addEventListener("mousemove",eval(events+"Fun")))}function offAllEvents(){var _this14=this;this.events=[],eventsList=eventsList.filter((function(e){return _this14.ID!==e.node.ID}));var temp=[];eventsList.forEach((function(e){temp.includes(e.events)||temp.push(e.events)})),temp.forEach((function(events){"hover"!==events&&"drag"!==events?(View2d.$el.removeEventListener(events,eval(events+"Fun")),View2d.$el.addEventListener(events,eval(events+"Fun"))):(View2d.$el.removeEventListener("mousemove",eval(events+"Fun")),View2d.$el.addEventListener("mousemove",eval(events+"Fun")))}))}function setEvents(events,callBack,callBack1,callBack2){var _this$events$filter,_this15=this,params=(_this$events$filter=this.events.filter((function(e){if(e.events!==events)return e;params=e.params})),_objectDestructuringEmpty(_this$events$filter),_this$events$filter);eventsList=eventsList.filter((function(e){return e.events!==events||e.events==events&&e.node.ID!==_this15.ID})),"hover"!==events&&"drag"!==events?(isDrag?this.dragEvents.push({events:events,isDrag:isDrag,isHover:!1,callBack:callBack,params:params}):this.events.push({events:events,isDrag:isDrag,isHover:!1,callBack:callBack,params:params}),eventsList.unshift({events:events,isDrag:isDrag,isHover:!1,callBack:callBack,node:this}),hasSetEvent.includes(events)&&(View2d.$el.removeEventListener(events,eval(events+"Fun")),hasSetEvent=hasSetEvent.filter((function(e){return e.events!=events}))),View2d.$el.addEventListener(events,eval(events+"Fun")),hasSetEvent.push(events)):("drag"==events||isDrag?this.dragEvents.push({events:events,isDrag:!0,isHover:!1,callBack:callBack,params:params}):this.events.push({events:events,isDrag:!1,isHover:!1,callBack:callBack,callBack1:callBack1,params:params}),eventsList.unshift({events:events,callBack:callBack,callBack1:callBack1,callBack2:callBack2,node:this}),hasSetEvent.includes(events)&&(View2d.$el.removeEventListener("mousemove",eval(events+"Fun")),hasSetEvent=hasSetEvent.filter((function(e){return e.events!=events}))),View2d.$el.addEventListener("mousemove",eval(events+"Fun")),hasSetEvent.push(events),"drag"==events&&(isDrag=!0,this.on("mousedown",(function(e){dragNodeZIndex=_this15.zIndex;var t=View2d.nodes.sort((function(e,t){return t.zIndex-e.zIndex}))[0].zIndex;if(_this15.zIndex=t+1,dragStartOffset={offsetX:e.clientX-_this15.position.x,offsetY:e.clientY-_this15.position.y},_this15.isMousedown=!0,"line"==_this15.type&&-1!==pointIndex){mousedownVertex=!0;var a=event.clientX-View2d.$el.getBoundingClientRect().left,n=event.clientY-View2d.$el.getBoundingClientRect().top;View2d.activeNode.linePath[pointIndex]={type:View2d.activeNode.linePath[pointIndex].type,x:a,y:n}}"function"==typeof callBack&&callBack.call(_this15,event)})),this.on("mouseup",(function(){if(_this15.isMousedown){if(_this15.isMousedown=!1,"line"==_this15.type&&-1!==pointIndex){var e=event.clientX-View2d.$el.getBoundingClientRect().left,t=event.clientY-View2d.$el.getBoundingClientRect().top,a=View2d.nodes.filter((function(e){return null!==e.zIndex}));a.sort((function(e,t){return t.zIndex-e.zIndex}));var n=a.filter((function(a){return a.checkPointInPath(e,t)}));findCenter(n,e,t),mousedownVertex=!1,pointIndex=-1}"function"==typeof callBack2&&callBack2.call(_this15,event),_this15.zIndex=dragNodeZIndex,View2d.baseLine.x=[],View2d.baseLine.y=[]}})),isDrag=!1))}function hoverFun(){var e=eventsList.filter((function(e){return"hover"==e.events}));eventHandle(e,event)}function dragFun(){var e=eventsList.filter((function(e){return"drag"==e.events}));eventHandle(e,event)}function clickFun(){var e=eventsList.filter((function(e){return"click"==e.events}));eventHandle(e,event)}function dblclickFun(){var e=eventsList.filter((function(e){return"dblclick"==e.events}));eventHandle(e,event)}function mouseupFun(){var e=eventsList.filter((function(e){return"mouseup"==e.events}));eventHandle(e,event)}function mousedownFun(){var e=eventsList.filter((function(e){return"mousedown"==e.events}));eventHandle(e,event)}function checkPointInPath(e,t){if(void 0!=this.vertex){var a=View2d.ctx,n=!1;return a.beginPath(),"line"!==this.type?(this.vertex.forEach((function(e){a.lineTo(e.x,e.y)})),n=a.isPointInPath(e,t)):(a.lineWidth=10,_darwlinePath(this.linePath,a),this.linePath.forEach((function(e){a.arc(e.x,e.y,8,0,2*Math.PI)})),n="waterCapacity"!==this.shape?a.isPointInStroke(e,t):a.isPointInPath(e,t)),n}}function isRangeIn(e,t,a){var n=parseFloat(e);return n<=t&&n>=a}window.addEventListener("mouseup",(function(){View2d.activeNode&&(View2d.activeNode.isMousedown=!1,hoverVertex=-1,mousedownVertex=!1),checkboxEnd()}));var mousedownVertex=!1,start={},end={},hoverVertex=-1,pointIndex=-1;function eventHandle(e,t){var a=View2d.nodes.find((function(e){return e.constructor===View2d.scene}));if(0===e.length||0===a.children.length)return View2d.$el.style.cursor="default",!1;var n=[];a.traverse((function(e){n.push(e.ID)}));var i=e.filter((function(e){return n.includes(e.node.ID)})),o=!1,r=t.clientX-View2d.$el.getBoundingClientRect().left,s=t.clientY-View2d.$el.getBoundingClientRect().top,l=View2d.nodes.filter((function(e){return null!==e.zIndex}));l.sort((function(e,t){return t.zIndex-e.zIndex}));var c=l.filter((function(e){return e.checkPointInPath(r,s)}));if(View2d.lock&&"drag"==i[0].events)return View2d.$el.style.cursor="default",!1;if(c.length>1){var d=c[0].events.concat(c[0].dragEvents);if(!d.map((function(e){return e.events})).includes(i[0].events)){var h=!1;if(c[0].constructor===View2d.Group&&d.traverse((function(e){e.includes(i[0].events)&&(h=!0)})),!h){var u=i.filter((function(e){return"hover"===e.events}))[0];return u&&"hover"===u.events&&u.isHover&&u.callBack1&&(u.callBack1.call(ele.node,t),u.isHover=!1),!1}}}if(View2d.lock||controler(r,s,c),hoverVertex>-1)return!1;if("preview"!==View2d.mode.type){if("mousedown"===t.type&&-1==hoverVertex)if(c.length>0)if(t.ctrlKey&&null!==View2d.activeNode&&View2d.activeNode.ID!==c[0].ID){var p=View2d.checkbox.checkboxGroup.children;0==p.length?(p.push(View2d.activeNode,c[0]),shortTimeCombine(p)):View2d.checkbox.checkboxGroup.add(c[0])}else l.forEach((function(e){e.helperBox=!1})),c[0].helperBox=!0,View2d.activeNode=c[0];else l.forEach((function(e){e.helperBox=!1})),View2d.activeNode=null,unShortTimeCombine();0==c.length&&"mousedown"==i[0].events&&checkboxStart(r,s),"mouseup"==i[0].events&&View2d.checkbox.show&&(t.stopPropagation(),checkboxEnd(r,s)),"drag"==i[0].events&&View2d.checkbox.show&&checkboxMove(r,s)}i.sort((function(e,t){return t.node.zIndex-e.node.zIndex})),i.forEach((function(e){View2d.nodes.find((function(e){return e.constructor===View2d.scene}));if(!View2d.nodes.some((function(t){return t.ID===e.node.ID})))return!1;if(e.node.checkPointInPath(r,s)&&!o||e.node.isMousedown){if(o=!0,"drag"!==e.events)e.isHover&&"hover"===e.events||(e.callBack.call(e.node,t),"click"==e.events&&(e.node.isOn=!e.node.isOn),"hover"===e.events&&(e.isHover=!0));else if("function"!=typeof e.callBack1||e.node.freeze||e.callBack1.call(e.node,t),e.node.isMousedown&&!e.node.freeze)if("line"!=e.node.type){var a=t.clientX-dragStartOffset.offsetX,n=t.clientY-dragStartOffset.offsetY;e.node.translate({x:a,y:n}),findVertex(a,n)}else if("line"==e.node.type&&mousedownVertex){var i=t.clientX-View2d.$el.getBoundingClientRect().left,l=t.clientY-View2d.$el.getBoundingClientRect().top;e.node.linePath[pointIndex].x=i,e.node.linePath[pointIndex].y=l}}else"hover"===e.events&&e.isHover&&("function"==typeof e.callBack1&&e.callBack1.call(e.node,t),e.isHover=!1);if(!e.node.checkPointInPath(r,s)&&"drag"==e.events&&e.node.isMousedown&&!e.node.freeze)if("line"!=e.node.type){var c=t.clientX-dragStartOffset.offsetX,d=t.clientY-dragStartOffset.offsetY;e.node.translate({x:c,y:d}),findVertex(c,d)}else if("line"==e.node.type&&mousedownVertex){var h=t.clientX-View2d.$el.getBoundingClientRect().left,u=t.clientY-View2d.$el.getBoundingClientRect().top;e.node.linePath[pointIndex].x=h,e.node.linePath[pointIndex].y=u}}))}function findVertex(e,t){var a=!1,n=!1,i={x:0,y:0},o=View2d.nodes.filter((function(e){return null!==e.zIndex}));if(null==View2d.activeNode||"preview"==View2d.mode.type)return!1;var r={xMin:View2d.activeNode.vertex[0].x,xMax:View2d.activeNode.vertex[1].x,yMin:View2d.activeNode.vertex[0].y,yMax:View2d.activeNode.vertex[2].y},s=View2d.baseLine.space||5;o.forEach((function(o){if(View2d.activeNode.ID!==o.ID&&"line"!==o.type){var l=o.vertex[0].x,c=o.vertex[1].x,d=o.vertex[0].y,h=o.vertex[2].y;for(var u in r)/^x/.test(u)&&(isRangeIn(r[u],l+s,l-s)&&(0==i.y&&(i.y=t),i.x=e+l-r[u],View2d.baseLine.x=[{x:l,y:0},{x:l,y:View2d.$el.height}],a=!0),isRangeIn(r[u],c+s,c-s)&&(0==i.y&&(i.y=t),i.x=e+c-r[u],View2d.baseLine.x=[{x:c,y:0},{x:c,y:View2d.$el.height}],a=!0)),/^y/.test(u)&&(isRangeIn(r[u],d+s,d-s)&&(0==i.x&&(i.x=e),i.y=t+d-r[u],View2d.baseLine.y=[{x:0,y:d},{x:View2d.$el.width,y:d}],n=!0),isRangeIn(r[u],h+s,h-s)&&(0==i.x&&(i.x=e),i.y=t+h-r[u],View2d.baseLine.y=[{x:0,y:h},{x:View2d.$el.width,y:h}],n=!0))}})),(a||n)&&View2d.activeNode.translate(i),a||(View2d.baseLine.x=[]),n||(View2d.baseLine.y=[])}function findCenter(e,t,a){if(e.length<=1)return!1;"line"!==e[1].type&&(View2d.activeNode.linePath[pointIndex]=_objectSpread({type:View2d.activeNode.linePath[pointIndex].type,id:e[1].ID},e[1].position))}function getCenterPoint(e,t){var a={x:e.x-(e.x-t.x)/2,y:e.y-(e.y-t.y)/2};return a}function getRotatePos(e,t,a){var n=t.x,i=t.y,o=(e.x-n)*Math.cos(a)-(e.y-i)*Math.sin(a)+n,r=(e.x-n)*Math.sin(a)+(e.y-i)*Math.cos(a)+i;return{x:o,y:r}}var RESIZECUR=[];function sortResizeCur(){var e=Math.abs(Math.round(View2d.activeNode.rotateVal%360/45));switch(e){case 0:RESIZECUR=["nw","s","ne","e","nw","s","ne","e"];break;case 1:RESIZECUR=["s","ne","e","nw","s","ne","e","nw"];break;case 2:RESIZECUR=["ne","e","nw","s","ne","e","nw","s"];break;case 3:RESIZECUR=["e","nw","s","ne","e","nw","s","ne"];break;case 4:RESIZECUR=["nw","s","ne","e","nw","s","ne","e"];break;case 5:RESIZECUR=["s","ne","e","nw","s","ne","e","nw"];break;case 6:RESIZECUR=["ne","e","nw","s","ne","e","nw","s"];break;case 7:RESIZECUR=["e","nw","s","ne","e","nw","s","ne"];break;case 8:RESIZECUR=["nw","s","ne","e","nw","s","ne","e"];break}}function controler(e,t,a){if("preview"==View2d.mode.type)return!1;if(mousedownVertex||(hoverVertex=-1),-1!=hoverVertex||mousedownVertex||(View2d.$el.style.cursor="",a.length>0&&!a[0].freeze&&a[0].dragEvents.map((function(e){return e.events})).includes("drag")&&"line"!==a[0].type&&(View2d.$el.style.cursor="move")),null!==View2d.activeNode)if("line"!=View2d.activeNode.type){if(View2d.activeNode.freeze)return!1;var n=JSON.parse(JSON.stringify(View2d.activeNode.vertex)),i={x:n[0].x+(n[1].x-n[0].x)/2,y:n[0].y+(n[1].y-n[0].y)/2},o=n.map((function(e){return e.x})).sort((function(e,t){return e-t})),r=n.map((function(e){return e.y})).sort((function(e,t){return e-t})),s={xMin:o[0],xMax:o[3],yMin:r[0],yMax:r[3]};s.xMin,s.xMax,s.yMin,s.yMax;if(-1==hoverVertex){sortResizeCur(),isRangeIn(e,n[0].x+5,n[0].x-5)&&isRangeIn(t,n[0].y+5,n[0].y-5)&&(hoverVertex=0,View2d.$el.style.cursor=RESIZECUR[0]+"-resize"),isRangeIn(e,n[1].x+5,n[1].x-5)&&isRangeIn(t,n[1].y+5,n[1].y-5)&&(hoverVertex=1,View2d.$el.style.cursor=RESIZECUR[2]+"-resize"),isRangeIn(e,n[2].x+5,n[2].x-5)&&isRangeIn(t,n[2].y+5,n[2].y-5)&&(hoverVertex=2,View2d.$el.style.cursor=RESIZECUR[4]+"-resize"),isRangeIn(e,n[3].x+5,n[3].x-5)&&isRangeIn(t,n[3].y+5,n[3].y-5)&&(hoverVertex=3,View2d.$el.style.cursor=RESIZECUR[6]+"-resize");var l=getCenterPoint(n[0],n[1]);isRangeIn(e,l.x+5,l.x-5)&&isRangeIn(t,l.y+5,l.y-5)&&(hoverVertex=.5,View2d.$el.style.cursor=RESIZECUR[1]+"-resize"),l=getCenterPoint(n[1],n[2]),isRangeIn(e,l.x+5,l.x-5)&&isRangeIn(t,l.y+5,l.y-5)&&(hoverVertex=1.5,View2d.$el.style.cursor=RESIZECUR[3]+"-resize"),l=getCenterPoint(n[2],n[3]),isRangeIn(e,l.x+5,l.x-5)&&isRangeIn(t,l.y+5,l.y-5)&&(hoverVertex=2.5,View2d.$el.style.cursor=RESIZECUR[5]+"-resize"),l=getCenterPoint(n[3],n[0]),isRangeIn(e,l.x+5,l.x-5)&&isRangeIn(t,l.y+5,l.y-5)&&(hoverVertex=3.5,View2d.$el.style.cursor=RESIZECUR[7]+"-resize");var c=50*Math.sin(View2d.activeNode.rotateVal*Math.PI/180),d=50*Math.cos(View2d.activeNode.rotateVal*Math.PI/180);isRangeIn(e,i.x+5+c,i.x-5+c)&&isRangeIn(t,i.y+5-d,i.y-5-d)&&(hoverVertex=4,View2d.$el.style.cursor="url(./img/rotate.ico) 16 16,default")}if("mousedown"===event.type&&hoverVertex>-1&&(mousedownVertex=!0,start={x:e,y:t}),mousedownVertex){var h=View2d.activeNode.rotateVal*Math.PI/180,u={xl:e-start.x,yl:t-start.y},p=View2d.activeNode.scaleVal.x,f=View2d.activeNode.scaleVal.y;start={x:e,y:t};var m=Math.atan2(u.yl,u.xl),v=Math.sqrt(u.xl*u.xl+u.yl*u.yl),x=m-h,w=n[0].x-n[1].x,_=n[0].y-n[1].y,y=Math.cos(x)*v/Math.sqrt(w*w+_*_);w=n[1].x-n[2].x,_=n[1].y-n[2].y;var b,g,V,k,P=Math.sin(x)*v/Math.sqrt(w*w+_*_),S={xl:Math.cos(x)*v/2,yl:Math.sin(x)*v/2};b=Math.cos(h)*S.xl,g=Math.sin(h)*S.xl,V=Math.sin(h)*S.yl,k=Math.cos(h)*S.yl;var C={xl:0,yl:0};switch(hoverVertex){case 0:if(p=View2d.activeNode.scaleVal.x-y*View2d.activeNode.scaleVal.x,f=View2d.activeNode.scaleVal.y-P*View2d.activeNode.scaleVal.y,p<.1||f<.1)break;C.xl-=V-b,C.yl+=k+g;break;case 1:if(p=View2d.activeNode.scaleVal.x+y*View2d.activeNode.scaleVal.x,f=View2d.activeNode.scaleVal.y-P*View2d.activeNode.scaleVal.y,p<.1||f<.1)break;C.xl-=V-b,C.yl+=k+g;break;case 2:if(p=View2d.activeNode.scaleVal.x+y*View2d.activeNode.scaleVal.x,f=View2d.activeNode.scaleVal.y+P*View2d.activeNode.scaleVal.y,p<.1||f<.1)break;C.xl-=V-b,C.yl+=k+g;break;case 3:if(p=View2d.activeNode.scaleVal.x-y*View2d.activeNode.scaleVal.x,f=View2d.activeNode.scaleVal.y+P*View2d.activeNode.scaleVal.y,p<.1||f<.1)break;C.xl-=V-b,C.yl+=k+g;break;case.5:if(f=View2d.activeNode.scaleVal.y-P*View2d.activeNode.scaleVal.y,f<.1)break;C.xl-=V,C.yl+=k;break;case 1.5:if(p=View2d.activeNode.scaleVal.x+y*View2d.activeNode.scaleVal.x,p<.1)break;C.xl+=b,C.yl+=g;break;case 2.5:if(f=View2d.activeNode.scaleVal.y+P*View2d.activeNode.scaleVal.y,f<.1)break;C.xl-=V,C.yl+=k;break;case 3.5:if(p=View2d.activeNode.scaleVal.x-y*View2d.activeNode.scaleVal.x,p<.1)break;C.xl+=b,C.yl+=g;break;case 4:var I=e-View2d.activeNode.position.x,N=t-View2d.activeNode.position.y,E=180*-Math.atan(I/N)/Math.PI;t<=s.yMin+(s.yMax-s.yMin)/2&&e>=s.xMin+(s.xMax-s.xMin)/2?View2d.activeNode.rotate(E):t<=s.yMin+(s.yMax-s.yMin)/2&&e<=s.xMin+(s.xMax-s.xMin)/2?View2d.activeNode.rotate(360+E):View2d.activeNode.rotate(180+E);break}if(4!==hoverVertex&&(View2d.activeNode.scale(p,f),View2d.activeNode.translate({x:View2d.activeNode.position.x+C.xl,y:View2d.activeNode.position.y+C.yl}),View2d.activeNode.echartsOption)){var T=echarts.init(View2d.activeNode.element);T.resize()}}if("mouseup"===event.type&&mousedownVertex&&(mousedownVertex=!1,end={x:e,y:t}),mousedownVertex)return}else mousedownVertex||(pointIndex=-1),View2d.activeNode.linePath.forEach((function(a,n){isRangeIn(e,a.x+5,a.x-5)&&isRangeIn(t,a.y+5,a.y-5)&&(View2d.$el.style.cursor="pointer",pointIndex=n)}))}function checkboxStart(e,t){View2d.checkbox.show=!0,View2d.checkbox.start={x:e,y:t},View2d.checkbox.end={x:e,y:t}}function checkboxMove(e,t){View2d.checkbox.end={x:e,y:t}}function checkboxEnd(e,t){if(View2d.checkbox.show){checkboxIncludeNode();View2d.checkbox.show=!1,View2d.checkbox.start={x:0,y:0},View2d.checkbox.end={x:0,y:0}}}function checkboxIncludeNode(){var e=[],t=View2d.checkbox,a=t.start,n=t.end,i=Math.min(a.x,n.x),o=Math.max(a.x,n.x),r=Math.min(a.y,n.y),s=Math.max(a.y,n.y);return View2d.nodes.forEach((function(t){if(null!==t.zIndex&&"line"!==t.type){var a={xMin:t.vertex[0].x,xMax:t.vertex[1].x,yMin:t.vertex[0].y,yMax:t.vertex[2].y};i<a.xMax&&o>a.xMin&&r<a.yMax&&s>a.yMin&&e.push(t)}else if(null!==t.zIndex&&"line"==t.type){var n=View2d.ctx,l=!1;2==t.linePath.length?(n.lineTo(t.linePath[0].x,t.linePath[0].y),n.lineTo(t.linePath[1].x,t.linePath[1].y)):_darwlinePath(t.linePath,n);for(var c=i;c<o;c++){for(var d=r;d<s;d++){var h=n.isPointInPath(c,d);if(h){l=!0;break}}if(l)break}l&&e.push(t)}})),e.length>0&&(e.length>1?shortTimeCombine(e):1==e.length&&(View2d.activeNode=e[0],e[0].helperBox=!0)),e}function scrollScale(){var e=0;event||(event=window.event),event.wheelDelta?(e=event.wheelDelta/120,window.opera&&(e=-e)):event.detail&&(e=-event.detail/3);var t=View2d.nodes.find((function(e){return e.constructor===View2d.scene})),a=t.scaleVal,n=a.x,i=a.y;e&&(n=Number((n+e*View2d.mode.zoom.rate*.1).toFixed(2)),i=Number((i+e*View2d.mode.zoom.rate*.1).toFixed(2)),(e<0&&n>View2d.mode.zoom.max||e>0&&n<View2d.mode.zoom.min)&&t.scale({x:event.offsetX,y:event.offsetY},n,i),(n>=View2d.mode.zoom.min&&n<View2d.mode.zoom.max||n>View2d.mode.zoom.min&&n<=View2d.mode.zoom.max)&&t.scale({x:event.offsetX,y:event.offsetY},n,i))}function shortTimeCombine(e){var t=View2d.nodes.find((function(e){return e.constructor==View2d.scene}));e=e.filter((function(e){return!e.freeze})),e=e.sort((function(e,t){return e.zIndex-t.zIndex}));var a=View2d.checkbox.checkboxGroup;a.children=[],a.vertex=void 0,a.add.apply(a,_toConsumableArray(e)),a.helperBox=!0,View2d.activeNode=a,t.add(a)}function unShortTimeCombine(){var e=View2d.nodes.find((function(e){return e.constructor==View2d.scene}));View2d.nodes.forEach((function(t){null!==t.zIndex&&"extraGroup"==t.type&&(e.remove(t),t.children.forEach((function(a){"line"!==a.type&&(a.rotateVal+=t.rotateVal,a.scaleVal.x+=a.scaleVal.x*(t.scaleVal.x-1),a.scaleVal.y+=a.scaleVal.y*(t.scaleVal.y-1)),a.freeze=t.freeze,"group"===a.type&&(a.groupPosition={x:0,y:0}),"drawEcharts"==a.shape&&View2d.$dom.appendChild(a.element),a.constructor==View2d.Group&&a.traverse((function(e){"drawEcharts"==e.shape&&View2d.$dom.appendChild(e.element)})),e.add(a)})),t.freeze=!1,t.children=[])}))}function radialGradient(){var e;if(0==this.vertex.length)return!1;var t=null,a={xMin:this.vertex[0].x/this.allScale.x,xMax:this.vertex[1].x/this.allScale.x,yMin:this.vertex[0].y/this.allScale.x,yMax:this.vertex[2].y/this.allScale.x},n=a.xMin,i=a.xMax,o=a.yMin,r=a.yMax,s=[{x:(n-i)/2,y:(o-r)/2},{x:(i-n)/2,y:(o-r)/2},{x:(i-n)/2,y:(r-o)/2},{x:(n-i)/2,y:(r-o)/2}],l=Math.abs(n-i)/2,c=["center","top","bottom","left","right","left top","right top","left bottom","right bottom"];switch(arguments[0]){case"center":s=[0,0,l/5,0,0,l];break;case"top":s=[0,-l,l/5,0,-l,2*l];break;case"bottom":s=[0,l,l/5,0,l,2*l];break;case"left":s=[-l,0,l/5,-l,0,2*l];break;case"right":s=[l,0,l/5,l,0,2*l];break;case"left top":s=[s[0].x,s[0].y,l/5,s[0].x,s[0].y,2*l];break;case"right top":s=[s[1].x,s[1].y,l/5,s[1].x,s[1].y,2*l];break;case"left bottom":s=[s[3].x,s[3].y,l/5,s[3].x,s[3].y,2*l];break;case"right bottom":s=[s[2].x,s[2].y,l/5,s[2].x,s[2].y,2*l];break;default:s=[0,0,l/5,0,0,l];break}t=(e=View2d.ctx).createRadialGradient.apply(e,_toConsumableArray(s));var d=0;for(var h in c.includes(arguments[0])&&(d=1),arguments)c.includes(arguments[h])||t.addColorStop(1*(Number(h)-d)/(arguments.length-1-d),arguments[h]);return t}function linearGradient(){var e;if(0==this.vertex.length)return!1;var t=null,a={xMin:this.vertex[0].x/this.allScale.x,xMax:this.vertex[1].x/this.allScale.x,yMin:this.vertex[0].y/this.allScale.y,yMax:this.vertex[2].y/this.allScale.y},n=a.xMin,i=a.xMax,o=a.yMin,r=a.yMax,s=[{x:(n-i)/2,y:(o-r)/2},{x:(i-n)/2,y:(o-r)/2},{x:(i-n)/2,y:(r-o)/2},{x:(n-i)/2,y:(r-o)/2}];switch(arguments[0]){case"to bottom":s=[s[0].x,s[0].y,s[3].x,s[3].y];break;case"to right":s=[s[0].x,s[0].y,s[1].x,s[1].y];break;case"45deg":s=[s[3].x,s[3].y,s[1].x,s[1].y];break;case"135deg":s=[s[0].x,s[0].y,s[2].x,s[2].y];break;default:s=[s[0].x,s[0].y,s[1].x,s[1].y];break}t=(e=View2d.ctx).createLinearGradient.apply(e,_toConsumableArray(s));var l=0,c=["to bottom","to right","45deg","135deg"];for(var d in c.includes(arguments[0])&&(l=1),arguments)c.includes(arguments[d])||t.addColorStop(1*(Number(d)-l)/(arguments.length-1-l),arguments[d]);return t}function nodeSetColor(node){var color=[];return node.color.forEach((function(item){"object"===_typeof(item)?color.push(eval(node[item.type+"Gradient"](item.direction,item.gradient[0],item.gradient[1]))):color.push(item)})),color}function polygon(e,t){var a,n,i=View2d.ctx,o=nodeSetColor(e);for(n=2*Math.PI/e.params.num,i.fillStyle=i.strokeStyle=o[0],i.save(),i.beginPath(),a=0;a<e.params.num;a++)i.rotate(n),i.lineTo(0,-e.params.w);i.closePath(),i.restore(),t&&i[e.drawType](),_setTopoBorder(e,t),i.rect(-e.params.w/2,-e.params.h/2,e.params.w,e.params.h)}function arc(e,t){var a=View2d.ctx,n=nodeSetColor(e);a.fillStyle=a.strokeStyle=n[0],a.beginPath(),a.arc(0,0,e.params.r,e.params.start,e.params.end),t&&a[e.drawType](),_setTopoBorder(e,t)}function rect(e,t){var a=View2d.ctx,n=nodeSetColor(e);a.fillStyle=a.strokeStyle=n[0],a.beginPath(),a.rect(-e.params.w/2,-e.params.h/2,e.params.w,e.params.h),t&&a[e.drawType](),_setTopoBorder(e,t)}function fivePointedStart(e,t){var a=View2d.ctx,n=nodeSetColor(e);a.fillStyle=a.strokeStyle=n[0],a.beginPath();for(var i=0;i<5;i++)a.lineTo(Math.cos((18+72*i)/180*Math.PI)*e.params.r,-Math.sin((18+72*i)/180*Math.PI)*e.params.r),a.lineTo(Math.cos((54+72*i)/180*Math.PI)*e.params.r/2.5,-Math.sin((54+72*i)/180*Math.PI)*e.params.r/2.5);a.closePath(),t&&a[e.drawType](),_setTopoBorder(e,t)}function channel(e,t,a){var n=a||View2d.ctx;e.offset=e.offset||0,e.isOn&&(e.offset+=e.speed||.2),n.lineWidth=e.lineWidth||20;var i=nodeSetColor(e),o=e.lineDash||[n.lineWidth,2*n.lineWidth];n.strokeStyle=i[0],n.lineCap="square",n.lineJoin="round",n.beginPath(),_darwlinePath(e.linePath,n),n.stroke(),n.strokeStyle=i[1],e.lineWidth?n.lineWidth=e.lineWidth-e.lineWidth/2.5:n.lineWidth=14,n.setLineDash(o),n.lineDashOffset-=5*e.offset,n.stroke()}function waterCapacity(e,t,a){var n,i,o,r,s=a||View2d.ctx,l=[],c=[],d=nodeSetColor(e);e.linePath.forEach((function(e){l.push(e.x),c.push(e.y)})),s.beginPath(),s.lineWidth=e.lineWidth||2,s.fillStyle=s.strokeStyle=d[0],_darwlinePath(e.linePath,s),s.clip(),s.closePath(),t&&s[e.drawType](),n=Math.max.apply(Math,l)+200,i=Math.min.apply(Math,l)-200,o=Math.max.apply(Math,c)+200,r=Math.min.apply(Math,c)-200,s.fillStyle=d[1],e.offset=e.offset||1,e.isOn&&(e.offset+=e.speed||.2),s.beginPath();var h=[{x:i,y:r},{x:n,y:r},{x:n,y:o},{x:i,y:o}],u=[].concat(h).reverse();u.forEach((function(t,a){if(2==a)for(var l=0,c=n;c>i;c-=(n-i)/200)l++,200===l&&(c=i),s.lineTo(c,o-(o-r)*e.waterHeight+2*Math.sin(.1*c+e.offset/5));else s.lineTo(t.x,t.y)})),s.closePath(),t&&s[e.drawType](),s.beginPath(),_darwlinePath(e.linePath,s)}function drawImage(e,t){var a=View2d.ctx,n=nodeSetColor(e);a.strokeStyle=a.fillStyle=n[0]||"#000",a.beginPath(),a.rect(-e.params.w/2,-e.params.h/2,e.params.w,e.params.h),t&&a[e.drawType](),a.strokeStyle=a.fillStyle=n[1]||"#fff",e.element&&e.src||(a.beginPath(),a.font="18px kaiTi",a.textAlign="center",a.fillText("图片加载失败",0,9),t&&a[e.drawType](),a.rect(-e.params.w/2,-e.params.h/2,e.params.w,e.params.h),t&&a.stroke()),a.beginPath(),a.rect(-e.params.w/2,-e.params.h/2,e.params.w,e.params.h),t&&e.element&&e.src&&(e.element.src=e.src,a.drawImage(e.element,-e.params.w/2,-e.params.h/2,e.params.w,e.params.h))}function drawVideo(e,t){var a=View2d.ctx,n=nodeSetColor(e);a.fillStyle=n[0]||"#000",a.beginPath(),a.rect(-e.params.w/2,-e.params.h/2,e.params.w,e.params.h),t&&a[e.drawType](),t&&e.src&&a.drawImage(e.element,-e.params.w/2,-e.params.h/2,e.params.w,e.params.h),e.isOn&&e.src?e.element.play():e.src?(e.element.pause(),a.fillStyle=n[1]||"#fff",a.beginPath(),a.lineTo(10/e.scaleVal.x,0),a.lineTo(-10/e.scaleVal.x,-15/e.scaleVal.y),a.lineTo(-10/e.scaleVal.x,15/e.scaleVal.y),t&&a.fill()):(a.fillStyle="#fff",a.beginPath(),a.font="18px kaiTi",a.textAlign="center",a.fillText("视频加载失败",0,9)),a.beginPath(),a.rect(-e.params.w/2,-e.params.h/2,e.params.w,e.params.h)}function drawText(e,t){var a=View2d.ctx,n=nodeSetColor(e);a.fillStyle=a.strokeStyle=n[0]||"#fff",a.beginPath(),a.rect(-e.params.w/2,-e.params.h/2,e.params.w,e.params.h),a.clip(),t&&a[e.drawType](),_setTopoBorder(e,t)}function drawEcharts(e,t){var a=View2d.ctx,n=nodeSetColor(e);if(e.element&&"preview"==View2d.mode.type){var i=e.position.x-e.params.w/2,o=e.position.y-e.params.h/2,r=e.rotateVal,s=e.scaleVal.x,l=e.scaleVal.y;void 0!==e.allScale&&(s=e.allScale.x,l=e.allScale.y,r=180*e.allRotate/Math.PI),e.element.style.left=i-(s-1)*e.params.w/2+"px",e.element.style.top=o-(l-1)*e.params.h/2+"px",e.element.style.width=s*e.params.w+"px",e.element.style.height=l*e.params.h+"px",e.element.style.pointerEvents="preview"==View2d.mode.type?"auto":"none",e.element.style.transform="rotateZ(".concat(r,"deg)")}a.fillStyle=a.strokeStyle=n[0],a.beginPath(),a.rect(-e.params.w/2,-e.params.h/2,e.params.w,e.params.h),t&&a[e.drawType](),t&&e.canvasImg&&"preview"!==View2d.mode.type&&a.drawImage(e.canvasImg,-e.params.w/2,-e.params.h/2,e.params.w,e.params.h),_setTopoBorder(e,t)}function drawSwitch(e,t){var a=View2d.ctx,n=nodeSetColor(e);a.beginPath(),a.fillStyle=a.strokeStyle=e.isOn?n[0]:"#ccc",a.save();for(var i=e.params,o=i.w,r=i.h,s=0;s<2;s++)a.rotate(Math.PI*s),a.lineTo(0,r/2),a.arc(-o/2+r/2,0,r/2,.5*Math.PI,1.5*Math.PI),a.lineTo(0,-r/2);a.closePath(),a.restore(),t&&a[e.drawType](),_setTopoBorder(e,t),a.beginPath(),a.fillStyle=n[1]||"#fff";var l=e.isOn?o/2-r/2:-o/2+r/2;a.arc(l,0,r/2-2,0,2*Math.PI),t&&a.fill(),a.beginPath(),a.fillStyle=n[2]||"#000",a.font="18px Kaiti",a.textAlign="center",t&&a.fillText(e.isOn?"on":"off",l,5),a.beginPath(),a.save();for(var c=0;c<2;c++)a.rotate(Math.PI*c),a.lineTo(0,r/2),a.arc(-o/2+r/2,0,r/2,.5*Math.PI,1.5*Math.PI),a.lineTo(0,-r/2);a.restore()}function drawFan(e,t){var a=View2d.ctx,n=nodeSetColor(e);e.offset=e.offset||0,e.offset+=e.speed||.8,a.rotate(20*e.offset*Math.PI/180);for(var i=0;i<4;i++)a.rotate(90*Math.PI/180),a.fillStyle=a.strokeStyle=n[0],a.beginPath(),a.arc(-e.params.w/2,-e.params.w/4,e.params.w/3,0,1.25*Math.PI),a.closePath(),t&&a[e.drawType]();a.fillStyle=a.strokeStyle=n[1],a.beginPath(),a.arc(0,0,e.params.w/3,0,2*Math.PI),t&&a[e.drawType](),a.beginPath(),a.arc(0,0,e.params.w,0,2*Math.PI),t&&e.border.show&&(a.lineWidth=e.border.lineWidth||2,a.strokeStyle=e.border.color||"red",a.lineCap=e.border.lineCap||"butt",a.lineJoin=e.border.lineJoin||"miter",a.setLineDash(e.border.lineDash||[0,0]),a.stroke())}function windmill(e,t){e.offset=e.offset||0,e.offset+=e.speed||.2;var a=View2d.ctx,n=nodeSetColor(e);a.save(),a.fillStyle=a.strokeStyle=n[0],a.translate(0,-e.params.h/2+e.params.w/2),a.rotate(10*e.offset*Math.PI/180);for(var i=0;i<3;i++)a.rotate(120*Math.PI/180),a.beginPath(),a.lineTo(-5,-5),a.lineTo(5,-5),a.lineTo(.5,-e.params.w),a.lineTo(-.5,-e.params.w),a.closePath(),t&&a[e.drawType]();a.restore(),a.fillStyle=a.strokeStyle=n[2],a.beginPath(),a.rect(-3,-e.params.h/2+e.params.w/2,6,e.params.h),t&&a[e.drawType](),a.fillStyle=a.strokeStyle=n[1],a.beginPath(),a.arc(0,-e.params.h/2+e.params.w/2,8,0,2*Math.PI),t&&a[e.drawType](),a.beginPath(),a.rect(-e.params.w,-e.params.h+e.params.w/2,2*e.params.w,e.params.h+e.params.w),t&&e.border.show&&(a.lineWidth=e.border.lineWidth||2,a.strokeStyle=e.border.color||"red",a.lineCap=e.border.lineCap||"butt",a.lineJoin=e.border.lineJoin||"miter",a.setLineDash(e.border.lineDash||[0,0]),a.stroke())}function clock(e,t){var a=new Date,n=a.getMilliseconds(),i=1e3*a.getSeconds()+n,o=60*a.getMinutes()*1e3+i,r=60*a.getHours()*60*1e3+o;r>12&&(r-=432e5);var s=View2d.ctx,l=nodeSetColor(e);s.lineCap="round",s.fillStyle=s.strokeStyle=l[0],s.lineWidth=5,s.beginPath(),s.arc(0,0,e.params.w,0,2*Math.PI),t&&(s[e.drawType](),s.stroke());var c=30;s.lineWidth=3;for(var d=1;d<=12;d++)s.save(),s.textAlign="center",s.font="12px blod",s.fillStyle=s.strokeStyle=l[1],s.beginPath(),s.rotate(c*d*Math.PI/180),s.lineTo(0,-e.params.w),s.lineTo(0,18*-e.params.w/20),t&&s.stroke(),s.fillStyle=s.strokeStyle=l[2],s.translate(0,16*-e.params.w/20),s.rotate(-c*d*Math.PI/180),s.fillText(d,0,5),s.restore();var h=6;s.lineWidth=1;for(var u=1;u<=60;u++)s.fillStyle=s.strokeStyle=l[1],s.save(),s.beginPath(),s.rotate(h*u*Math.PI/180),s.lineTo(0,-e.params.w),s.lineTo(0,19*-e.params.w/20),t&&s.stroke(),s.restore();var p=30/3600/1e3;s.save(),s.fillStyle=s.strokeStyle=l[5],s.lineWidth=5,s.rotate(p*r*Math.PI/180),s.beginPath(),s.lineTo(0,5),s.lineTo(0,-e.params.w/2.5),t&&s.stroke(),s.restore();var f=1e-4;s.save(),s.fillStyle=s.strokeStyle=l[4],s.lineWidth=3,s.rotate(f*o*Math.PI/180),s.beginPath(),s.lineTo(0,5),s.lineTo(0,-e.params.w/2),t&&s.stroke(),s.restore();var m=.006;s.save(),s.fillStyle=s.strokeStyle=l[3],s.lineWidth=2,s.rotate(m*i*Math.PI/180),s.beginPath(),s.lineTo(0,5),s.lineTo(0,-e.params.w/1.5),t&&s.stroke(),s.restore(),s.fillStyle=s.strokeStyle=l[6],s.beginPath(),s.arc(0,0,3,0,2*Math.PI),t&&s.fill(),s.beginPath(),s.arc(0,0,e.params.w,0,2*Math.PI),_setTopoBorder(e,t)}function light(e,t){e.offset=e.offset||0,e.isOn&&(e.offset>6&&(e.offset=0),e.offset+=e.speed||.1);var a=View2d.ctx,n=nodeSetColor(e);a.beginPath(),a.fillStyle=a.strokeStyle=n[0],a.arc(0,0,8,0,2*Math.PI),t&&a[e.drawType](),a.fillStyle=a.strokeStyle=n[1],a.save(),a.beginPath(),a.arc(0,0,8+2*e.offset,0,2*Math.PI),t&&a.stroke(),a.restore(),a.beginPath(),a.arc(0,0,20,0,2*Math.PI)}function dom(e,t){var a=View2d.ctx;if(e.element){var n=e.position.x-e.params.w/2,i=e.position.y-e.params.h/2,o=e.rotateVal,r=e.scaleVal.x,s=e.scaleVal.y;void 0!==e.parentId&&(parent=e.findParent(),r+=r*(parent.scaleVal.x-1),s+=s*(parent.scaleVal.y-1)),e.element.style.left=n+"px",e.element.style.top=i+"px",e.element.style.pointerEvents="preview"==View2d.mode.type?"auto":"none",e.element.style.transform="rotateZ(".concat(o,"deg) scale(").concat(r,", ").concat(s,")")}var l=nodeSetColor(e);a.fillStyle=l[0],a.beginPath(),a.rect(-e.params.w/2,-e.params.h/2,e.params.w,e.params.h),t&&a.fill()}function bezierLine(e,t,a){var n=a||View2d.ctx;n.lineWidth=e.lineWidth||1,n.lineCap=e.lineCap||"rect";var i=e.lineDash||[0,0];n.setLineDash(i);var o=nodeSetColor(e);n.fillStyle=o[1],n.strokeStyle=o[0],e.helperBox&&(n.shadowBlur=5,n.shadowColor=e.freeze?"#ccc":"red"),_darwlinePath(e.linePath,n),t&&n[e.drawType]()}function _darwlinePath(e,t){var a=[];e.forEach((function(e,t){if(void 0!==e.id){var n=getNodeById(e.id),i={x:0,y:0};i=void 0!==n?n.position:{x:e.x,y:e.y},a.push(_objectSpread({type:e.type||"straight"},i))}else a.push(_objectSpread({type:e.type||"straight"},e))}));var n=a.length;if(n<2)return!1;if(t.beginPath(),t.moveTo(a[0].x,a[0].y),2===n)t.lineTo(a[1].x,a[1].y);else{for(var i=[],o=1;o<n-1;o++)i=i.concat(_getControlpoint([a[o-1],a[o],a[o+1]]));var r=2;for("curve"==a[1].type?t.quadraticCurveTo(i[0].x,i[0].y,a[1].x,a[1].y):t.lineTo(a[1].x,a[1].y),r;r<n-1;r++)"curve"==a[r].type?t.bezierCurveTo(i[2*(r-2)+1].x,i[2*(r-2)+1].y,i[2*(r-1)].x,i[2*(r-1)].y,a[r].x,a[r].y):t.lineTo(a[r].x,a[r].y);"curve"==a[r].type?t.quadraticCurveTo(i[2*(r-2)+1].x,i[2*(r-2)+1].y,a[r].x,a[r].y):t.lineTo(a[r].x,a[r].y)}}function _getDistance(e,t){return Math.sqrt(Math.pow(e.x+t.x,2)+Math.pow(e.y+e.y,2))}function _getControlpoint(e){var t=_getDistance(e[0],e[1]),a=_getDistance(e[1],e[2]),n=t+a,i=[e[2].x-e[0].x,e[2].y-e[0].y];return[{x:e[1].x-.5*i[0]*t/n,y:e[1].y-.5*i[1]*t/n},{x:e[1].x+.5*i[0]*t/n,y:e[1].y+.5*i[1]*t/n}]}function _setTopoBorder(e,t){var a=View2d.ctx;t&&e.border.show&&(a.lineWidth=e.border.lineWidth||1,a.strokeStyle=e.border.color||"red",a.lineCap=e.border.lineCap||"butt",a.lineJoin=e.border.lineJoin||"miter",a.setLineDash(e.border.lineDash||[0,0]),a.stroke())}function L_header(e,t){var a=View2d.ctx,n=nodeSetColor(e);a.beginPath(),a.rect(-e.params.w/2,-e.params.h/2,e.params.w,e.params.h),a.save();var i=View2d.nodes.find((function(e){return e.constructor===View2d.scene}));a.font="".concat(e.text.fontStyle," ").concat(e.text.fontWeight," ").concat(e.text.fontSize,"px ").concat(e.text.fontFamily);for(var o=e.allScale||{x:1,y:1},r=a.measureText(e.text.content).width/o.x*i.scaleVal.x,s=0;s<2;s++)1==s&&(a.scale(1,-1),a.rotate(Math.PI)),a.beginPath(),a.fillStyle=a.strokeStyle=n[1]||"#4eddcc",a.lineTo(0,20),a.lineTo(-r/2,20),a.lineTo(-r/2-30,-20),a.lineTo(0,-20),t&&a.stroke(),a.beginPath(),a.fillStyle=a.strokeStyle=n[0]||"#4eddcc",a.lineTo(0,25),a.lineTo(-r/2-2,25),a.lineTo(-r/2-36,-20),a.lineTo(-r/2-e.params.w/5,-20),a.lineTo(-r/2-e.params.w/4,20),a.lineTo(-e.params.w/2,20),t&&a.stroke();a.restore(),a.beginPath(),a.rect(-e.params.w/2,-e.params.h/2,e.params.w,e.params.h),_setTopoBorder(e,t)}function L_left(e,t){var a=View2d.ctx,n=nodeSetColor(e);a.fillStyle=a.strokeStyle=n[0]||"#fff",a.beginPath(),a.rect(-e.params.w/2,-e.params.h/2,e.params.w,e.params.h),a.save();for(var i=0;i<2;i++)1==i&&(a.scale(-1,1),a.rotate(Math.PI)),a.beginPath(),a.lineTo(-e.params.w/2+20,0),a.lineTo(-e.params.w/2+20,100),a.lineTo(-e.params.w/2,150),a.lineTo(-e.params.w/2,e.params.h/2),a.lineTo(e.params.w/2,e.params.h/2),a.lineTo(e.params.w/2,0),t&&a.stroke();a.restore(),a.beginPath(),a.beginPath(),a.rect(-e.params.w/2,-e.params.h/2,e.params.w,e.params.h),_setTopoBorder(e,t)}function L_right(e,t){var a=View2d.ctx,n=nodeSetColor(e);a.fillStyle=a.strokeStyle=n[0]||"#fff",a.beginPath(),a.rect(-e.params.w/2,-e.params.h/2,e.params.w,e.params.h),a.save();for(var i=0;i<2;i++)1==i&&(a.scale(-1,1),a.rotate(Math.PI)),a.beginPath(),a.lineTo(e.params.w/2-20,0),a.lineTo(e.params.w/2-20,100),a.lineTo(e.params.w/2,150),a.lineTo(e.params.w/2,e.params.h/2),a.lineTo(-e.params.w/2,e.params.h/2),a.lineTo(-e.params.w/2,0),t&&a.stroke();a.restore(),a.beginPath(),a.beginPath(),a.rect(-e.params.w/2,-e.params.h/2,e.params.w,e.params.h),_setTopoBorder(e,t)}function L_center(e,t){var a=View2d.ctx,n=nodeSetColor(e);a.fillStyle=a.strokeStyle=n[0]||"#fff",a.beginPath(),a.rect(-e.params.w/2,-e.params.h/2,e.params.w,e.params.h),a.save();for(var i=0;i<2;i++)1==i&&(a.scale(-1,1),a.rotate(Math.PI)),a.beginPath(),a.lineTo(e.params.w/2,0),a.lineTo(e.params.w/2,e.params.h/2),a.lineTo(-e.params.w/2,e.params.h/2),a.lineTo(-e.params.w/2,0),t&&a.stroke();a.restore(),a.beginPath(),a.beginPath(),a.rect(-e.params.w/2,-e.params.h/2,e.params.w,e.params.h),_setTopoBorder(e,t)}function L_bottom(e,t){var a=View2d.ctx,n=nodeSetColor(e);a.fillStyle=a.strokeStyle=n[0]||"#fff",a.beginPath(),a.rect(-e.params.w/2,-e.params.h/2,e.params.w,e.params.h),a.save();for(var i=0;i<2;i++)1==i&&(a.scale(-1,1),a.rotate(Math.PI)),a.beginPath(),a.lineTo(e.params.w/2,0),a.lineTo(e.params.w/2,e.params.h/2),a.lineTo(-e.params.w/2,e.params.h/2),a.lineTo(-e.params.w/2,0),t&&a.stroke();a.restore(),a.beginPath(),a.beginPath(),a.rect(-e.params.w/2,-e.params.h/2,e.params.w,e.params.h),_setTopoBorder(e,t)}function L_box(e,t){var a=View2d.ctx,n=nodeSetColor(e);a.beginPath(),a.rect(-e.params.w/2,-e.params.h/2,e.params.w,e.params.h),a.save();var i=View2d.nodes.find((function(e){return e.constructor===View2d.scene}));a.font="".concat(e.text.fontStyle," ").concat(e.text.fontWeight," ").concat(e.text.fontSize,"px ").concat(e.text.fontFamily);for(var o=e.allScale||{x:1,y:1},r=a.measureText(e.text.content).width/o.x*i.scaleVal.x,s=0;s<2;s++){1==s&&(a.scale(1,-1),a.rotate(Math.PI)),a.beginPath(),a.fillStyle=a.strokeStyle=n[0]||"#4eddcc",a.lineTo(0,40-e.params.h/2),a.lineTo(-r/2-8,40-e.params.h/2),a.lineTo(-r/2-20,30-e.params.h/2),a.lineTo(-r/2-70,30-e.params.h/2),a.lineTo(-r/2-100,5-e.params.h/2),a.lineTo(-r/2-120,5-e.params.h/2),a.lineTo(-r/2-150,5-e.params.h/2),a.lineTo(-e.params.w/2+30,5-e.params.h/2),a.arc(-e.params.w/2+10,15-e.params.h/2,5,0,2*Math.PI),a.lineTo(-e.params.w/2+5,5-e.params.h/2+30),a.lineTo(-e.params.w/2+5,-130),a.lineTo(-e.params.w/2+20,-100),a.lineTo(-e.params.w/2+20,100),a.lineTo(-e.params.w/2+5,130),a.lineTo(-e.params.w/2+5,e.params.h/2-30),a.lineTo(-e.params.w/2+30,e.params.h/2-5),a.lineTo(0,e.params.h/2-5),t&&a.stroke(),a.beginPath(),a.fillStyle=a.strokeStyle=n[1]||"#4eddcc",a.lineTo(0,30-e.params.h/2),a.lineTo(-r/2,30-e.params.h/2),a.lineTo(-r/2-10,20-e.params.h/2),a.lineTo(-r/2-60,20-e.params.h/2),a.lineTo(-r/2-80,-e.params.h/2),a.lineTo(-r/2-150,-e.params.h/2),a.lineTo(-e.params.w/2,-e.params.h/2),a.lineTo(-e.params.w/2,-e.params.h/2),a.lineTo(-e.params.w/2,e.params.h/2),a.lineTo(0,e.params.h/2),t&&a.stroke(),a.fillStyle=a.strokeStyle=n[2]||"#4eddcc";for(var l=0;l<3;l++)a.beginPath(),a.lineTo(-r/2-10,15-5*l-e.params.h/2),a.lineTo(-r/2-55-5*l,15-5*l-e.params.h/2),a.lineTo(-r/2-60-5*l,13-5*l-e.params.h/2),a.lineTo(-r/2-10,13-5*l-e.params.h/2),a.closePath(),t&&a.fill()}a.restore(),a.beginPath(),a.rect(-e.params.w/2,-e.params.h/2,e.params.w,e.params.h),_setTopoBorder(e,t)}function oval(e,t){var a=View2d.ctx,n=nodeSetColor(e);a.beginPath(),a.fillStyle=a.strokeStyle=n[0],a.save();for(var i=e.params,o=i.w,r=i.h,s=0;s<2;s++)a.rotate(Math.PI*s),a.lineTo(0,r/2),a.arc(-o/2+r/2,0,r/2,.5*Math.PI,1.5*Math.PI),a.lineTo(0,-r/2);a.closePath(),a.restore(),t&&a[e.drawType](),_setTopoBorder(e,t)}function parallelogram(e,t){var a=View2d.ctx,n=nodeSetColor(e);a.fillStyle=a.strokeStyle=n[0],a.beginPath(),a.save(),a.transform(1,0,-25*Math.PI/180,1,0,0),a.rect(-e.params.w/2,-e.params.h/2,e.params.w,e.params.h),t&&a[e.drawType](),a.restore(),_setTopoBorder(e,t)}function arrow(e,t){var a=View2d.ctx,n=nodeSetColor(e);a.beginPath(),a.fillStyle=a.strokeStyle=n[0],a.lineTo(-e.params.w/2,0),a.lineTo(e.params.w/2-30,0),a.lineTo(e.params.w/2-30,10),a.lineTo(e.params.w/2,0),a.lineTo(e.params.w/2-30,-10),a.lineTo(e.params.w/2-30,0),t&&a.stroke(),a.beginPath(),a.rect(-e.params.w/2,-e.params.h/2,e.params.w,e.params.h)}return View2d}))},"0ace":function(e,t,a){e.exports=a.p+"static/img/rect.a66d3060.svg"},"0e6d":function(e,t,a){e.exports=a.p+"static/img/angle.59d52993.svg"},"0fc5":function(e,t,a){},1692:function(e,t,a){},1876:function(e,t,a){e.exports=a.p+"static/img/left.accfbcf5.svg"},"18e9":function(e,t,a){e.exports=a.p+"static/img/text.bf4a5141.svg"},"1e07":function(e,t,a){"use strict";a("21d0")},"1e85":function(e,t,a){e.exports=a.p+"static/img/fivePointedStart.2731e9ff.svg"},"21d0":function(e,t,a){},2922:function(e,t,a){"use strict";a("1692")},"2b96":function(e,t,a){e.exports=a.p+"static/img/circleCharts.c414ae54.svg"},"2ea5":function(e,t,a){},5316:function(e,t,a){e.exports=a.p+"static/img/header.59face62.svg"},"56d7":function(e,t,a){"use strict";a.r(t);a("c8ba"),a("5961"),a("7ecd"),a("0185");var n=a("430a"),i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"app"}},[a("router-view")],1)},o=[],r={},s=r,l=(a("5c0b"),a("cba8")),c=Object(l["a"])(s,i,o,!1,null,null,null),d=c.exports,h=a("7736"),u={userEquipment:{userName:"",userEquipmentGroup:[]},collapse:!1,file:{name:"",data:[]},data:{scale:1,lineName:"curve",fromArrowType:"",toArrowType:"triangleSolid",locked:0,bkColor:"",bkImage:"",grid:!0,websocket:""},resetLink:{count:0},viewData:{},event:{name:"",data:null},canvas:null,error:{text:""}},p=(a("3e22"),{emit:function(e,t){e.event=t},addView:function(e,t){e.viewData=t},change:function(e,t){e.data=t},dataScale:function(e,t){e.data.scale=t},changeFileName:function(e,t){e.file.name=t},changeBkImage:function(e,t){e.data.bkImage=t},changeBkColor:function(e,t){e.data.bkColor=t},changeGrid:function(e,t){e.data.grid=t},changeWebscoket:function(e,t){e.data.websocket=t},resetWebScoket:function(e){e.resetLink.count++},canvasChange:function(e,t){e.canvas=t},addEquipment:function(e,t){e.userEquipment.userEquipmentGroup=t},addEquipmentGroup:function(e,t){e.userEquipment.userEquipmentGroup=t}});n["default"].use(h["a"]);var f=new h["a"].Store({state:u,mutations:p}),m=f,v=(a("a9b6"),a("2690"),a("d4f9"),a("ac56")),x=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"content"},[a("div",{directives:[{name:"show",rawName:"v-show",value:"/workspace"!==this.$route.path,expression:"this.$route.path !== '/workspace'"}],ref:"pageMenu",staticClass:"pageMenu"},[a("el-menu",{staticClass:"el-menu-vertical-demo",attrs:{"default-active":this.$route.path,"background-color":"#2265ac","text-color":"#fff","active-text-color":"#409EFF",collapse:e.collapse,router:!0},on:{select:e.onSelecte}},[a("el-menu-item",{attrs:{index:"/"}},[a("i",{staticClass:"el-icon-menu"}),a("span",{attrs:{slot:"title"},slot:"title"},[e._v("首页")])]),a("el-submenu",{attrs:{index:"0"}},[a("template",{slot:"title"},[a("i",{staticClass:"el-icon-s-platform"}),a("span",[e._v("设备管理")])]),a("el-menu-item",{attrs:{index:"/add-equipment"}},[e._v("添加设备")]),a("el-menu-item",{attrs:{index:"/list-equipment"}},[e._v("设备列表")])],2),a("el-menu-item",{attrs:{index:"/workspace"}},[a("i",{staticClass:"el-icon-s-tools"}),a("span",{attrs:{slot:"title"},slot:"title"},[e._v("云组态")])])],1)],1),a("div",{staticClass:"item-page"},[a("router-view")],1)])},w=[],_={computed:{collapse:function(){return this.$store.state.collapse}},watch:{"$route.path":function(){this.onSelecte(this.$route.path)}},methods:{onSelecte:function(e){"/workspace"===e?(this.$store.state.collapse=!0,this.$refs.pageMenu.style.width="64px"):(this.$store.state.collapse=!1,this.$refs.pageMenu.style.width="200px")}},mounted:function(){this.onSelecte(this.$route.path)}},y=_,b=(a("e2ef"),Object(l["a"])(y,x,w,!1,null,"1c8c6bbc",null)),g=b.exports;a("6f68");n["default"].use(v["a"]);var V=[{path:"/",component:g,children:[{path:"",name:"index",component:function(){return a.e("chunk-918896dc").then(a.bind(null,"1e4b"))}},{path:"/add-equipment",name:"add-equipment",component:function(){return a.e("chunk-81c54cfa").then(a.bind(null,"4585"))}},{path:"/list-equipment",name:"list-equipment",component:function(){return a.e("chunk-2534d0d6").then(a.bind(null,"bd18"))}},{path:"/workspace",name:"workspace",component:function(){return Promise.resolve().then(a.bind(null,"6f68"))}}]},{path:"/preview",name:"preview",component:function(){return a.e("chunk-18aa8ace").then(a.bind(null,"a64c"))}}],k=new v["a"]({mode:"hash",base:"",routes:V}),P=k,S=a("82ae"),C=a.n(S),I=a("5422"),N=a.n(I);a("e9b7");n["default"].use(N.a),n["default"].config.productionTip=!1,n["default"].config.devtools=!0,n["default"].prototype.$axios=C.a,C.a.interceptors.response.use((function(e){if(e&&e.data)return e.data})),new n["default"]({router:P,store:m,render:function(e){return e(d)}}).$mount("#app")},"5c0b":function(e,t,a){"use strict";a("7df9")},"5ef0":function(e,t,a){e.exports=a.p+"static/img/diamond.6f3f1da7.svg"},"6aae":function(e,t,a){},"6ad5":function(e,t,a){e.exports=a.p+"static/img/right.e72664c0.svg"},"6ba3":function(e,t,a){e.exports=a.p+"static/img/switch.0bc7ce1b.svg"},"6ce6":function(e,t,a){e.exports=a.p+"static/img/lineCharts.ad42e07d.svg"},"6f68":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"page",style:"width:"+e.width},[a("div",{staticClass:"headTool"},[a("home-header",{on:{change:e.changeSceneScale}})],1),a("div",{staticClass:"tools"},[a("div",{staticStyle:{width:"100%"}},[a("el-collapse",{staticStyle:{width:"100%"},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},e._l(e.tools,(function(t,n){return a("el-collapse-item",{key:n,attrs:{title:t.title+"("+t.data.length+")",name:n}},[a("div",{staticStyle:{display:"flex","flex-wrap":"wrap"}},e._l(t.data,(function(t,n){return a("div",{key:n,staticClass:"item",attrs:{draggable:!0},on:{dragstart:function(a){return e.onDrag(a,t.node)}}},[a("img",{attrs:{width:"35",height:"35",src:t.icon,alt:"",srcset:""}})])})),0)])})),1)],1)]),a("div",{staticClass:"full",attrs:{id:"view2d-canvas"},on:{click:e.onClickBlank,drop:e.getData,dragover:function(e){e.preventDefault()},contextmenu:function(t){return e.onContextMenu(t)}}},[e.contextmenu.left?a("div",{staticClass:"context-menu",style:this.contextmenu},[a("CanvasContextMenu",{attrs:{Node:e.Node,scene:e.scene},on:{closeMenu:function(t){e.contextmenu.left=null},update:e.updateNode,"update:Node":function(t){e.Node=t},"update:node":function(t){e.Node=t}}})],1):e._e()]),a("div",{staticClass:"props",style:e.props.expand?"overflow: visible":""},[a("CanvasProps",{attrs:{Node:e.Node,name:e.topoName},on:{"update:name":function(t){e.topoName=t},change:e.onUpdateProps}})],1),a("el-dialog",{attrs:{title:"新建组态",visible:e.topoShow,width:"25%"},on:{"update:visible":function(t){e.topoShow=t}}},[a("div",{staticClass:"topoName"},[a("span",{staticClass:"nameLabel"},[e._v("组态名称：")]),a("el-input",{attrs:{placeholder:"请输入设备组名称",size:"small"},model:{value:e.topoName,callback:function(t){e.topoName=t},expression:"topoName"}})],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.topoShow=!1}}},[e._v("取消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.onCreateTopo}},[e._v("确定")])],1)])],1)},i=[],o=a("b5e5"),r=a("fef3"),s=a("02a9"),l=(a("e186"),a("3e22"),a("16e1"),a("3fab"),a("ed02"),a("a9b6"),a("2690"),a("d4f9"),a("e793"),a("a16b"),a("c284"),a("0a59")),c=a.n(l),d={title:"画笔图形",data:[{name:"矩形水容器",icon:a("e734"),node:{shape:"waterCapacity",drawType:"fill",lineWidth:2,isOn:!0,speed:.2,waterHeight:.5,color:["rgba(21,115,151,0.5)","#2cafe7"],linePath:[]}},{name:"水管",icon:a("b91d"),node:{shape:"channel",drawType:"fill",lineWidth:5,lineDash:[10,20],isOn:!0,speed:.2,color:["#fff","#2cafe7"],linePath:[]}},{name:"曲线",icon:a("79a5"),node:{shape:"bezierLine",drawType:"stroke",lineWidth:1,color:["red"],linePath:[]}}]},h={title:"基本图形",data:[{name:"圆",icon:a("aae0"),node:{shape:"arc",drawType:"fill",text:{content:"圆"},color:["#2cafe7"],lineWidth:1,params:{r:50,start:0,end:2*Math.PI},position:{x:0,y:0}}},{name:"矩形",icon:a("0ace"),node:{shape:"rect",drawType:"fill",lineWidth:2,color:["#2cafe7"],text:{content:"呜呼！楚虽三户能亡秦，岂有堂堂中国空无人！",padding:[0,0],color:"",fontSize:18,fontFamily:"",fontStyle:"italic",textAlign:"center",textVertical:"top",textShadowColor:"#000",textShadowBlur:3,textShadowOffsetX:2,textShadowOffsetY:2},params:{w:100,h:100},position:{x:0,y:0}}},{name:"三角形",icon:a("0e6d"),node:{shape:"polygon",drawType:"fill",color:["#2cafe7"],lineWidth:1,params:{w:50,h:50,num:3},position:{x:0,y:0}}},{name:"菱形",icon:a("5ef0"),node:{shape:"polygon",drawType:"fill",color:["#2cafe7"],lineWidth:1,params:{w:50,h:50,num:4},position:{x:0,y:0}}},{name:"五边形",icon:a("9dce"),node:{shape:"polygon",drawType:"fill",color:["#2cafe7"],text:{content:"五边形"},border:{show:!1,color:"red",lineWidth:1,lineCap:"square",lineJoin:"round"},lineWidth:1,params:{w:50,h:50,num:5},position:{x:0,y:0}}},{name:"八边形",icon:a("fa2d"),node:{shape:"polygon",drawType:"fill",color:["#2cafe7"],lineWidth:1,text:{content:"八边形"},params:{w:50,h:50,num:8},position:{x:0,y:0}}},{name:"五角星",icon:a("1e85"),node:{shape:"fivePointedStart",drawType:"fill",color:["#2cafe7"],params:{r:50},position:{x:0,y:0}}},{name:"闪灯",icon:a("9bfe"),node:{shape:"light",drawType:"fill",isOn:!0,speed:.05,color:["#ff0000","#ff0000"],position:{x:0,y:0}}},{name:"钟表",icon:a("ea63"),node:{shape:"clock",drawType:"stroke",isOn:!0,color:["#2cafe7","#fff","#fff","red","#fff","#fff","red"],params:{w:100,h:150},position:{x:0,y:0}}},{name:"大风车",icon:a("accc"),node:{shape:"windmill",color:["#2cafe7","#fff","#2cafe7"],drawType:"fill",speed:.1,params:{w:80,h:150},position:{x:0,y:0}}},{name:"视频",icon:a("ec75"),node:{shape:"drawVideo",drawType:"fill",isOn:!1,src:"./img/mov_bbb.mp4",params:{w:150,h:100},position:{x:0,y:0}}},{name:"图片",icon:a("fa14"),node:{shape:"drawImage",drawType:"fill",src:"https://img1.baidu.com/it/u=3632732758,1898142214&fm=26&fmt=auto",color:["rgba(0,0,0,0)"],params:{w:150,h:100},position:{x:0,y:0}}},{name:"文本",icon:a("18e9"),node:{shape:"drawText",text:{content:"文本内容"},color:["#2cafe7"],params:{w:150,h:100},position:{x:0,y:0}}},{name:"风扇",icon:a("ce6f"),node:{shape:"drawFan",drawType:"fill",color:["#2cafe7","#fff"],speed:.3,params:{w:80,h:80},position:{x:0,y:0}}},{name:"开关",icon:a("6ba3"),node:{shape:"drawSwitch",color:["#2cafe7","#fff","#ccc"],isOn:!0,position:{x:0,y:0},params:{w:80,h:40}}}]},u={title:"流程图",data:[{name:"椭圆",icon:a("0ace"),node:{shape:"oval",drawType:"stroke",lineWidth:1,text:{content:"开始",fontSize:16,color:"#eee"},color:["#eee"],params:{w:80,h:40},position:{x:0,y:0}}},{name:"长方形",icon:a("0ace"),node:{shape:"rect",drawType:"stroke",lineWidth:1,text:{content:"过程",fontSize:16,color:"#eee"},color:["#eee"],params:{w:100,h:40},position:{x:0,y:0}}},{name:"菱形",icon:a("5ef0"),node:{shape:"polygon",drawType:"stroke",lineWidth:1,text:{content:"决策",fontSize:16,color:"#eee"},color:["#eee"],params:{w:40,h:40,num:4},position:{x:0,y:0}}},{name:"平行四边形",icon:a("0ace"),node:{shape:"parallelogram",drawType:"stroke",lineWidth:1,text:{content:"数据",fontSize:16,color:"#eee"},color:["#eee"],params:{w:80,h:40},position:{x:0,y:0}}},{name:"六边形",icon:a("0ace"),node:{shape:"polygon",drawType:"stroke",lineWidth:1,text:{content:"准备",fontSize:16,color:"#eee"},color:["#eee"],params:{w:50,h:20,num:6},position:{x:0,y:0}}},{name:"箭头",icon:a("0ace"),node:{shape:"arrow",drawType:"stroke",lineWidth:1,color:["#eee"],params:{w:200,h:40},position:{x:0,y:0}}}]},p={title:"大屏组件",data:[{name:"头部",icon:a("5316"),node:{shape:"L_header",drawType:"fill",lineWidth:2,text:{content:"xxx在线监测系统",fontSize:25,color:"#2cafe7"},color:["#2cafe7","#2cafe7"],params:{w:1200,h:70},position:{x:0,y:0}}},{name:"左侧",icon:a("1876"),node:{shape:"L_left",drawType:"stroke",lineWidth:2,text:{content:"左侧布局",fontSize:25,color:"#fff"},color:["#2cafe7","#2cafe7"],params:{w:200,h:400},position:{x:0,y:0}}},{name:"右侧",icon:a("6ad5"),node:{shape:"L_right",drawType:"fill",lineWidth:2,text:{content:"右侧布局",fontSize:25,color:"#fff"},color:["#2cafe7","#2cafe7"],params:{w:200,h:400},position:{x:0,y:0}}},{name:"中心",icon:a("9f0b"),node:{shape:"L_center",lineWidth:2,text:{content:"中心布局",fontSize:20,color:"#fff"},color:["#2cafe7","#2cafe7"],params:{w:800,h:400},position:{x:0,y:0}}},{name:"底部",icon:a("9f0b"),node:{shape:"L_bottom",lineWidth:2,text:{content:"底部",fontSize:25,color:"#fff"},color:["#2cafe7","#2cafe7"],params:{w:1200,h:180},position:{x:0,y:0}}},{name:"头部",icon:a("5316"),node:{shape:"L_box",drawType:"fill",lineWidth:1,text:{content:"xxx在线监测系统",fontSize:20,color:"#2cafe7",textVertical:"top"},color:["#2cafe7","#2cafe7","#2cafcc"],params:{w:1280,h:640},position:{x:0,y:0}}}]},f={title:"数据图表",data:[{name:"折线图",icon:a("6ce6"),animate:!1,node:{shape:"drawEcharts",color:["#fff"],params:{w:300,h:200},echartsOption:{color:["#409EFF"],tooltip:{trigger:"axis"},xAxis:{type:"category",data:["Mon","Tue","Wed","Thu","Fri","Sat","Sun"]},yAxis:{type:"value"},series:[{data:[820,932,901,934,1290,1330,1320],type:"line",smooth:!0}]},position:{x:0,y:0}}},{name:"柱状图",icon:a("80c7"),node:{shape:"drawEcharts",color:["#fff"],params:{w:300,h:200},echartsOption:{color:["#409EFF"],tooltip:{trigger:"axis"},xAxis:{type:"category",data:["Mon","Tue","Wed","Thu","Fri","Sat","Sun"]},yAxis:{type:"value"},series:[{data:[120,200,150,80,70,110,130],type:"bar"}]},position:{x:0,y:0}}},{name:"雷达图",icon:a("8e30"),node:{shape:"drawEcharts",color:["#fff"],params:{w:300,h:200},echartsOption:{legend:{data:["预算分配","实际开销"],top:"20"},grid:{left:"10%",right:"10%",top:10,bottom:10},radar:{indicator:[{name:"销售",max:6500},{name:"管理",max:16e3},{name:"信息技术",max:3e4},{name:"客服",max:38e3},{name:"研发",max:52e3},{name:"市场",max:25e3}]},series:[{name:"预算 vs 开销",type:"radar",data:[{value:[4200,3e3,2e4,35e3,5e4,18e3],name:"预算分配"},{value:[5e3,14e3,28e3,26e3,42e3,21e3],name:"实际开销"}]}]},position:{x:0,y:0}}},{name:"饼图",icon:a("f788"),node:{shape:"drawEcharts",color:["#fff"],params:{w:300,h:200},echartsOption:{tooltip:{trigger:"item"},legend:{left:"center"},series:[{name:"访问来源",type:"pie",radius:"50%",data:[{value:1048,name:"搜索引擎"},{value:735,name:"直接访问"},{value:580,name:"邮件营销"},{value:484,name:"联盟广告"},{value:300,name:"视频广告"}],emphasis:{itemStyle:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}}]},position:{x:0,y:0}}},{name:"环形图",icon:a("2b96"),node:{shape:"drawEcharts",color:["#fff"],params:{w:300,h:200},echartsOption:{tooltip:{trigger:"item"},legend:{top:"2%",left:"left"},series:[{name:"访问来源",type:"pie",radius:["40%","70%"],avoidLabelOverlap:!1,itemStyle:{borderRadius:10,borderColor:"#fff",borderWidth:2},label:{show:!1,position:"center"},emphasis:{label:{show:!0,fontSize:"16",fontWeight:"bold"}},labelLine:{show:!1},data:[{value:1048,name:"搜索引擎"},{value:735,name:"直接访问"},{value:580,name:"邮件营销"},{value:484,name:"联盟广告"},{value:300,name:"视频广告"}]}]},position:{x:0,y:0}}},{name:"仪表盘",icon:a("929d"),node:{shape:"drawEcharts",color:["#fff"],params:{w:300,h:200},echartsOption:{tooltip:{formatter:"{a} <br/>{b} : {c}%"},toolbox:{feature:{restore:{},saveAsImage:{}}},series:[{name:"业务指标",type:"gauge",detail:{formatter:"{value}%"},data:[{value:50,name:"完成率"}]}]},position:{x:0,y:0}}}]},m=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[e.Node?a("div",[a("el-tabs",{attrs:{stretch:!0},on:{"tab-click":e.initData},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[a("el-tab-pane",{attrs:{label:"显示设置",name:"first"}},[a("div",{staticClass:"itemBox"},["node"==e.Node.type?a("div",[a("div",{staticClass:"title"},[e._v("背景和边框")]),a("div",{staticClass:"items flex column"},[a("div",{staticClass:"flex middle mb5"},[a("label",{staticClass:"ml5 mr5",attrs:{for:""}},[e._v("绘制方式:")]),a("el-select",{attrs:{placeholder:"请选择",size:"small"},model:{value:e.Node.drawType,callback:function(t){e.$set(e.Node,"drawType",t)},expression:"Node.drawType"}},e._l([{label:"填充",value:"fill"},{label:"轮廓",value:"stroke"}],(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),a("div",{staticClass:"flex middle mb5",staticStyle:{"flex-wrap":"wrap"}},[a("label",{staticClass:"ml5 mr5",attrs:{for:""}},[e._v("背景颜色:")]),e._l(e.Node.color,(function(t,n){return a("el-popover",{key:n,attrs:{placement:"bottom",width:"230"},on:{show:function(t){return e.openSelected(n)}},model:{value:e.showSelectedColor[n],callback:function(t){e.$set(e.showSelectedColor,n,t)},expression:"showSelectedColor[i]"}},[a("div",{staticClass:"flex middle mb5"},[a("label",{staticClass:"ml5 mr5",attrs:{for:""}},[e._v("背景类型:")]),a("el-select",{attrs:{placeholder:"请选择",size:"small"},on:{change:function(t){return e.selectedType(n)}},model:{value:e.backgroundType,callback:function(t){e.backgroundType=t},expression:"backgroundType"}},e._l([{label:"单色背景",value:0},{label:"线性渐变背景",value:1},{label:"径向渐变背景",value:2}],(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),"string"==typeof t&&e.showSelectedColor[n]?a("div",{directives:[{name:"show",rawName:"v-show",value:0==e.backgroundType,expression:"backgroundType == 0"}],staticClass:"flex middle mb5"},[a("label",{staticClass:"ml5 mr5",attrs:{for:""}},[e._v("背景颜色:")]),a("el-color-picker",{attrs:{"show-alpha":"",size:"small"},on:{change:e.onChangeColor},model:{value:e.Node.color[n],callback:function(t){e.$set(e.Node.color,n,t)},expression:"Node.color[i]"}})],1):e._e(),"object"==typeof t&&e.showSelectedColor[n]?a("div",{directives:[{name:"show",rawName:"v-show",value:0!==e.backgroundType,expression:"backgroundType !== 0"}]},[a("div",{staticClass:"flex middle"},[a("span",[e._v("渐变分向：")]),1==e.backgroundType?a("el-select",{staticStyle:{width:"140px"},attrs:{placeholder:"请选择",size:"small"},model:{value:e.Node.color[n].direction,callback:function(t){e.$set(e.Node.color[n],"direction",t)},expression:"Node.color[i].direction"}},e._l([{label:"水平渐变",value:"to right"},{label:"垂直渐变",value:"to bottom"},{label:"左上到右下",value:"135deg"},{label:"左下到右上",value:"45deg"}],(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1):a("el-select",{staticStyle:{width:"140px"},attrs:{placeholder:"请选择",size:"small"},model:{value:e.Node.color[n].direction,callback:function(t){e.$set(e.Node.color[n],"direction",t)},expression:"Node.color[i].direction"}},e._l([{label:"中心渐变",value:"center"},{label:"顶部渐变",value:"top"},{label:"底部渐变",value:"bottom"},{label:"左侧渐变",value:"left"},{label:"右侧渐变",value:"right"}],(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),a("div",{staticClass:"flex middle"},[a("span",[e._v("开始颜色：")]),a("el-color-picker",{attrs:{"show-alpha":"",size:"small"},model:{value:e.Node.color[n].gradient[0],callback:function(t){e.$set(e.Node.color[n].gradient,0,t)},expression:"Node.color[i].gradient[0]"}}),a("span",[e._v("结束颜色：")]),a("el-color-picker",{attrs:{"show-alpha":"",size:"small"},model:{value:e.Node.color[n].gradient[1],callback:function(t){e.$set(e.Node.color[n].gradient,1,t)},expression:"Node.color[i].gradient[1]"}})],1)]):e._e(),"string"==typeof t?a("span",{staticClass:"color-ball",style:"background:"+t,attrs:{slot:"reference"},slot:"reference"}):e._e(),"object"==typeof t&&"linear"==t.type?a("span",{staticClass:"color-ball",style:"background:"+t.type+"-gradient("+t.direction+","+t.gradient[0]+","+t.gradient[1],attrs:{slot:"reference"},slot:"reference"}):e._e(),"object"==typeof t&&"radial"==t.type?a("span",{staticClass:"color-ball",style:"background:"+t.type+"-gradient("+t.gradient[0]+","+t.gradient[1],attrs:{slot:"reference"},slot:"reference"}):e._e()])}))],2),a("div",{staticClass:"flex middle mb5"},[a("label",{staticClass:"ml5 mr5",attrs:{for:""}},[e._v("边框显示:")]),a("el-switch",{attrs:{"active-color":"#13ce66","inactive-colori":"#ccc","active-value":!0,"inactive-value":!1},model:{value:e.Node.border.show,callback:function(t){e.$set(e.Node.border,"show",t)},expression:"Node.border.show"}})],1),a("div",{directives:[{name:"show",rawName:"v-show",value:e.Node.border.show,expression:"Node.border.show"}]},[a("div",{staticClass:"flex middle mb5"},[a("label",{staticClass:"ml5 mr5",attrs:{for:""}},[e._v("边框颜色:")]),a("el-color-picker",{attrs:{"show-alpha":"",size:"small"},model:{value:e.Node.border.color,callback:function(t){e.$set(e.Node.border,"color",t)},expression:"Node.border.color"}})],1),a("div",{staticClass:"flex middle mb5"},[a("label",{staticClass:"ml5 mr5",attrs:{for:""}},[e._v("边框宽度:")]),a("el-input-number",{staticStyle:{flex:"1"},attrs:{min:1,"controls-position":"right",size:"small"},model:{value:e.Node.border.lineWidth,callback:function(t){e.$set(e.Node.border,"lineWidth",t)},expression:"Node.border.lineWidth"}})],1),a("div",{staticClass:"flex middle mb5"},[a("label",{staticClass:"ml5 mr5",attrs:{for:""}},[e._v("线条样式:")]),a("el-select",{attrs:{placeholder:"请选择",size:"small"},on:{change:e.lineDashChange},model:{value:e.lineDash,callback:function(t){e.lineDash=t},expression:"lineDash"}},e._l(e.lineOption,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)]),a("div",{staticClass:"flex middle mb5"},[a("label",{staticClass:"ml5 mr5",attrs:{for:""}},[e._v("阴影颜色:")]),a("el-color-picker",{attrs:{"show-alpha":"",size:"small"},model:{value:e.Node.shadowColor,callback:function(t){e.$set(e.Node,"shadowColor",t)},expression:"Node.shadowColor"}})],1),a("div",{staticClass:"flex middle mb5"},[a("label",{staticClass:"ml5 mr5",attrs:{for:""}},[e._v("阴影大小:")]),a("el-input-number",{staticStyle:{flex:"1"},attrs:{min:0,"controls-position":"right",size:"small"},model:{value:e.Node.shadowBlur,callback:function(t){e.$set(e.Node,"shadowBlur",t)},expression:"Node.shadowBlur"}})],1),a("div",{staticClass:"flex middle mb5"},[a("label",{staticClass:"ml5 mr5",attrs:{for:""}},[e._v("阴影X偏移:")]),a("el-input-number",{staticStyle:{flex:"1"},attrs:{"controls-position":"right",size:"small"},model:{value:e.Node.shadowOffsetX,callback:function(t){e.$set(e.Node,"shadowOffsetX",t)},expression:"Node.shadowOffsetX"}})],1),a("div",{staticClass:"flex middle mb5"},[a("label",{staticClass:"ml5 mr5",attrs:{for:""}},[e._v("阴影Y偏移:")]),a("el-input-number",{staticStyle:{flex:"1"},attrs:{"controls-position":"right",size:"small"},model:{value:e.Node.shadowOffsetY,callback:function(t){e.$set(e.Node,"shadowOffsetY",t)},expression:"Node.shadowOffsetY"}})],1)])]):e._e(),"line"!==e.Node.type?a("div",[a("div",{staticClass:"title"},[e._v("位置和变换")]),a("div",{staticClass:"flex column mt5 mb5"},[a("div",{staticClass:"flex middle mb5"},[a("label",{staticClass:"ml5 mr5",attrs:{for:""}},[e._v("X坐标:")]),a("el-input-number",{staticStyle:{flex:"1"},attrs:{"controls-position":"right",size:"small"},on:{change:function(t){return e.Node.translate(e.position)}},model:{value:e.position.x,callback:function(t){e.$set(e.position,"x",t)},expression:"position.x"}})],1),a("div",{staticClass:"flex middle mb5"},[a("label",{staticClass:"ml5 mr5",attrs:{for:""}},[e._v("Y坐标:")]),a("el-input-number",{staticStyle:{flex:"1"},attrs:{"controls-position":"right",size:"small"},on:{change:function(t){return e.Node.translate(e.position)}},model:{value:e.position.y,callback:function(t){e.$set(e.position,"y",t)},expression:"position.y"}})],1),a("div",{staticClass:"flex middle mb5"},[a("label",{staticClass:"ml5 mr5",attrs:{for:""}},[e._v("X缩放:")]),a("el-input-number",{staticStyle:{flex:"1"},attrs:{"controls-position":"right",step:.1,min:.1,size:"small"},on:{change:function(t){return e.Node.scale(e.scaleVal.x,e.scaleVal.y)}},model:{value:e.scaleVal.x,callback:function(t){e.$set(e.scaleVal,"x",t)},expression:"scaleVal.x"}})],1),a("div",{staticClass:"flex middle mb5"},[a("label",{staticClass:"ml5 mr5",attrs:{for:""}},[e._v("Y缩放:")]),a("el-input-number",{staticStyle:{flex:"1"},attrs:{"controls-position":"right",step:.1,min:.1,size:"small"},on:{change:function(t){return e.Node.scale(e.scaleVal.x,e.scaleVal.y)}},model:{value:e.scaleVal.y,callback:function(t){e.$set(e.scaleVal,"y",t)},expression:"scaleVal.y"}})],1),a("div",{staticClass:"flex middle mb5"},[a("label",{staticClass:"ml5 mr5",attrs:{for:""},domProps:{innerHTML:e._s("&ensp;旋转:")}}),a("el-input-number",{staticStyle:{flex:"1"},attrs:{"controls-position":"right",size:"small"},on:{change:function(t){return e.Node.rotate(e.rotateVal)}},model:{value:e.rotateVal,callback:function(t){e.rotateVal=t},expression:"rotateVal"}})],1)])]):e._e()]),"node"==e.Node.type?a("div",{staticClass:"itemBox"},[a("div",{staticClass:"title"},[e._v("文本样式")]),a("div",{staticClass:"flex column mt5 mb5"},[a("div",{staticClass:"flex middle mb5"},[a("label",{staticClass:"ml5 mr5",attrs:{for:""},domProps:{innerHTML:e._s("内&emsp;&emsp;容:")}}),a("el-input",{staticStyle:{flex:"1"},attrs:{clearable:"",size:"small"},model:{value:e.Node.text.content,callback:function(t){e.$set(e.Node.text,"content",t)},expression:"Node.text.content"}})],1),void 0!=e.Node.src?a("div",{staticClass:"flex middle mb5"},[a("label",{staticClass:"ml5 mr5",attrs:{for:""},domProps:{innerHTML:e._s("图片地址:")}}),a("el-input",{staticStyle:{flex:"1"},attrs:{clearable:"",size:"small"},model:{value:e.Node.src,callback:function(t){e.$set(e.Node,"src",t)},expression:"Node.src"}})],1):e._e(),a("div",{staticClass:"flex middle mb5"},[a("label",{staticClass:"ml5 mr5",attrs:{for:""}},[e._v("字体颜色:")]),a("el-color-picker",{attrs:{"show-alpha":"",size:"small"},model:{value:e.Node.text.color,callback:function(t){e.$set(e.Node.text,"color",t)},expression:"Node.text.color"}})],1),a("div",{staticClass:"flex middle mb5"},[a("label",{staticClass:"ml5 mr5",attrs:{for:""}},[e._v("字体大小:")]),a("el-input-number",{staticStyle:{flex:"1"},attrs:{min:12,"controls-position":"right",size:"small"},model:{value:e.Node.text.fontSize,callback:function(t){e.$set(e.Node.text,"fontSize",t)},expression:"Node.text.fontSize"}})],1),a("div",{staticClass:"flex middle mb5"},[a("label",{staticClass:"ml5 mr5",attrs:{for:""}},[e._v("字体粗细:")]),a("el-select",{staticClass:"select",attrs:{"value-key":"value",size:"small",placeholder:"选择设备组"},model:{value:e.Node.text.fontWeight,callback:function(t){e.$set(e.Node.text,"fontWeight",t)},expression:"Node.text.fontWeight"}},e._l(e.weightOption,(function(e,t){return a("el-option",{key:t,attrs:{value:e.value,label:e.label}})})),1)],1),a("div",{staticClass:"flex middle mb5"},[a("label",{staticClass:"ml5 mr5",attrs:{for:""}},[e._v("字体风格:")]),a("el-select",{staticClass:"select",attrs:{"value-key":"value",size:"small",placeholder:"选择设备组"},model:{value:e.Node.text.fontStyle,callback:function(t){e.$set(e.Node.text,"fontStyle",t)},expression:"Node.text.fontStyle"}},e._l(e.fontStyleOption,(function(e,t){return a("el-option",{key:t,attrs:{value:e.value,label:e.label}})})),1)],1),a("div",{staticClass:"flex middle mb5"},[a("label",{staticClass:"ml5 mr5",attrs:{for:""}},[e._v("水平对齐:")]),a("el-select",{staticClass:"select",attrs:{"value-key":"value",size:"small",placeholder:"选择设备组"},model:{value:e.Node.text.textAlign,callback:function(t){e.$set(e.Node.text,"textAlign",t)},expression:"Node.text.textAlign"}},e._l(e.textAlignOption,(function(e,t){return a("el-option",{key:t,attrs:{value:e.value,label:e.label}})})),1)],1),a("div",{staticClass:"flex middle mb5"},[a("label",{staticClass:"ml5 mr5",attrs:{for:""}},[e._v("垂直对齐:")]),a("el-select",{staticClass:"select",attrs:{"value-key":"value",size:"small",placeholder:"选择设备组"},model:{value:e.Node.text.textVertical,callback:function(t){e.$set(e.Node.text,"textVertical",t)},expression:"Node.text.textVertical"}},e._l(e.textVerticalOption,(function(e,t){return a("el-option",{key:t,attrs:{value:e.value,label:e.label}})})),1)],1),a("div",{staticClass:"flex middle mb5"},[a("label",{staticClass:"ml5 mr5",attrs:{for:""}},[e._v("水平边距:")]),a("el-input-number",{staticStyle:{flex:"1"},attrs:{min:0,"controls-position":"right",size:"small"},model:{value:e.Node.text.padding[1],callback:function(t){e.$set(e.Node.text.padding,1,t)},expression:"Node.text.padding[1]"}})],1),a("div",{staticClass:"flex middle mb5"},[a("label",{staticClass:"ml5 mr5",attrs:{for:""}},[e._v("垂直边距:")]),a("el-input-number",{staticStyle:{flex:"1"},attrs:{min:0,"controls-position":"right",size:"small"},model:{value:e.Node.text.padding[0],callback:function(t){e.$set(e.Node.text.padding,0,t)},expression:"Node.text.padding[0]"}})],1)])]):e._e(),"line"==e.Node.type?a("div",[a("div",{staticClass:"flex middle mb5",staticStyle:{"flex-wrap":"wrap"}},[a("label",{staticClass:"ml5 mr5",attrs:{for:""}},[e._v("线条颜色:")]),e._l(e.Node.color,(function(t,n){return a("el-color-picker",{key:n,attrs:{"show-alpha":"",size:"small"},model:{value:e.Node.color[n],callback:function(t){e.$set(e.Node.color,n,t)},expression:"Node.color[i]"}})}))],2),a("div",{staticClass:"flex middle mb5"},[a("label",{staticClass:"ml5 mr5",attrs:{for:""}},[e._v("线条宽度:")]),a("el-input-number",{staticStyle:{flex:"1"},attrs:{min:1,"controls-position":"right",size:"small"},model:{value:e.Node.lineWidth,callback:function(t){e.$set(e.Node,"lineWidth",t)},expression:"Node.lineWidth"}})],1),a("div",{staticClass:"flex middle mb5"},[a("label",{staticClass:"ml5 mr5",attrs:{for:""}},[e._v("线条样式:")]),a("el-select",{attrs:{placeholder:"请选择",size:"small"},on:{change:e.lineDashChange},model:{value:e.lineDash,callback:function(t){e.lineDash=t},expression:"lineDash"}},e._l(e.lineOption,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)]):e._e()]),a("el-tab-pane",{attrs:{label:"数据连接",name:"second"}},[a("div",{staticClass:"flex justify-around mt5 mb10"},[a("label",{staticClass:"ml5"},[e._v("设备组:")]),a("div",{staticClass:"flex mb10"},[a("el-select",{staticClass:"select",attrs:{"value-key":"value",size:"small",placeholder:"选择设备组"},model:{value:e.equipment,callback:function(t){e.equipment=t},expression:"equipment"}},e._l(e.group,(function(e,t){return a("el-option",{key:t,attrs:{value:e.equipmentList,label:e.groupName}})})),1)],1)]),a("div",{staticClass:"flex justify-around mt5 mb10"},[a("label",{staticClass:"ml5"},[e._v("设备:")]),a("div",{staticClass:"flex mb10"},[a("el-select",{staticClass:"select",attrs:{disabled:!e.equipment.length,size:"small",placeholder:"请先选择设备组"},model:{value:e.sensor,callback:function(t){e.sensor=t},expression:"sensor"}},e._l(e.equipment,(function(e,t){return a("el-option",{key:t,attrs:{value:e.sensorList,label:e.equipmentName}})})),1)],1)]),a("div",{staticClass:"border-bottom flex justify-around mt5 mb10"},[a("label",{staticClass:"ml5"},[e._v("传感器:")]),a("div",{staticClass:"flex mb10"},[a("el-select",{staticClass:"select",attrs:{disabled:!e.sensor.length,size:"small",placeholder:"请先选择设备"},model:{value:e.selectedSensor,callback:function(t){e.selectedSensor=t},expression:"selectedSensor"}},e._l(e.sensor,(function(e,t){return a("el-option",{key:t,attrs:{value:e.name,label:e.name}})})),1)],1)]),a("div",{staticClass:"flex justify-around mt10 mb10 "},[a("label",{staticClass:"ml5"},[e._v("类型设置:")]),a("div",{staticClass:"flex mb10"},[a("el-select",{staticClass:"select",attrs:{size:"small"},on:{change:e.onSelectedSensor},model:{value:e.selectedSensorType,callback:function(t){e.selectedSensorType=t},expression:"selectedSensorType"}},e._l(e.typeOption,(function(e,t){return a("el-option",{key:t,attrs:{value:e.value,label:e.text}})})),1)],1)]),a("div",{staticClass:"flex justify-around mt10 mb10"},[a("el-button",{staticStyle:{width:"100%"},attrs:{type:"primary",size:"small"},on:{click:e.onLinkSensor}},[e._v("确定连接")])],1)]),a("el-tab-pane",{attrs:{label:"事件",name:"third"}},[a("el-button",{staticStyle:{width:"100%"},attrs:{type:"primary",size:"small"},on:{click:function(t){return e.Node.events.push({params:{}})}}},[e._v("添加事件")]),e._l(e.Node.events,(function(t,n){return a("div",{key:n,staticClass:" flex column"},[a("h3",{staticClass:"border-bottom pv10"},[a("span",{staticClass:"mr15"},[e._v("事件")]),a("el-button",{attrs:{type:"danger",icon:"el-icon-delete",size:"mini",circle:""},on:{click:function(t){return e.Node.events.splice(n,1)}}})],1),a("div",{staticClass:"mb10"},[a("label",[e._v("事件类型：")]),a("el-select",{attrs:{size:"mini"},on:{change:function(a){return e.onSelectEventDo(t,n)}},model:{value:t.events,callback:function(a){e.$set(t,"events",a)},expression:"item.events"}},[a("el-option",{attrs:{value:"click",label:"点击事件"}}),a("el-option",{attrs:{value:"dblclick",label:"双击事件"}}),a("el-option",{attrs:{value:"hover",label:"鼠标hover事件"}})],1)],1),a("div",{staticClass:"mb10"},[a("label",[e._v("事件行为：")]),a("el-select",{attrs:{size:"mini"},on:{change:function(a){return e.onSelectEventDo(t,n)}},model:{value:t.params.type,callback:function(a){e.$set(t.params,"type",a)},expression:"item.params.type"}},[a("el-option",{attrs:{value:0,label:"打开链接"}}),a("el-option",{attrs:{value:1,label:"显示信息"}}),a("el-option",{attrs:{value:2,label:"执行自定义js代码"}}),a("el-option",{attrs:{value:3,label:"ajax异步请求"}})],1)],1),3==t.params.type?a("div",{staticClass:" flex column mt10"},[a("h3",{staticClass:"ml5 mt5 mb10 border-bottom"},[e._v("自定义接口API")]),a("div",[a("label",{staticClass:"ml5 mt5 mb10"},[e._v("API地址:")]),a("el-input",{staticClass:"mb10",attrs:{placeholder:"例如：http//www.xxxxx.com/api...",size:"small"},on:{change:function(a){return e.onSelectEventDo(t,n)}},model:{value:t.params.APIUrl,callback:function(a){e.$set(t.params,"APIUrl",a)},expression:"item.params.APIUrl"}})],1),a("div",[a("label",{staticClass:"ml5 mt5 mb10"},[e._v("请求类型"+e._s(t.params.APIType)+":")]),a("div",{staticClass:"flex mb10"},[a("el-select",{staticClass:"mr5",attrs:{size:"small"},on:{change:function(a){return e.onSelectEventDo(t,n)}},model:{value:t.params.APIType,callback:function(a){e.$set(t.params,"APIType",a)},expression:"item.params.APIType"}},[a("el-option",{attrs:{value:"get",label:"get"}}),a("el-option",{attrs:{value:"post",label:"post"}})],1)],1)]),a("div",[a("label",{staticClass:"ml5 mt5 mb10"},[e._v("请求参数:")]),a("div",{staticClass:"flex mb10"},[a("el-input",{staticClass:"mr5",attrs:{type:"textArea",rows:5,placeholder:"例如：{pmId: 10}",size:"small"},on:{change:function(a){return e.onSelectEventDo(t,n)}},model:{value:t.params.APIParams,callback:function(a){e.$set(t.params,"APIParams",a)},expression:"item.params.APIParams"}}),a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(a){return e.onLinkAPI(e.Node,t)}}},[e._v("查看接口数据")])],1)]),e.Node.data?a("div"):e._e(),a("div",[a("label",{staticClass:"ml5 mt5 mb10"},[e._v("绑定哪个字段:")]),a("div",{staticClass:"flex gird"},[a("el-input",{staticClass:"mr5",attrs:{placeholder:"例如：data.name",size:"small"},on:{change:function(a){return e.onSelectEventDo(t,n)}},model:{value:t.params.bindValue,callback:function(a){e.$set(t.params,"bindValue",a)},expression:"item.params.bindValue"}})],1)])]):1!==t.params.type?a("div",[a("div",{staticClass:"mb10"},[0==t.params.type?a("label",[e._v("链接地址：")]):e._e(),2==t.params.type?a("label",[e._v("自定js代码：")]):e._e(),a("el-input",{staticClass:"mb5",attrs:{type:"textarea",rows:2==t.params.type||3==t.params.type?15:1},on:{change:function(a){return e.onSelectEventDo(t,n)}},model:{value:t.params.value,callback:function(a){e.$set(t.params,"value",a)},expression:"item.params.value"}})],1)]):e._e()])}))],2)],1)],1):a("div",[a("div",{staticClass:"title"},[e._v("基本设置")]),a("div",{staticClass:"ph20 flex mt10"},[a("label",{staticClass:"mr5"},[e._v("图文名称:")]),a("el-input",{attrs:{size:"small"},on:{change:e.onChangeFileName},model:{value:e.fileName,callback:function(t){e.fileName=t},expression:"fileName"}})],1),a("div",{staticClass:"ph20 flex mt10"},[a("label",{staticClass:"mr5"},[e._v("背景颜色:")]),a("el-input",{attrs:{size:"small"},on:{change:e.onChangeColor},model:{value:e.bgColor,callback:function(t){e.bgColor=t},expression:"bgColor"}}),a("el-color-picker",{attrs:{size:"small"},on:{change:e.onChangeColor},model:{value:e.bgColor,callback:function(t){e.bgColor=t},expression:"bgColor"}})],1),a("div",{staticClass:"ph20 flex mt10"},[a("label",{staticClass:"mr5"},[e._v("背景图片:")]),a("el-button",{attrs:{type:"info",size:"mini",plain:"",round:""},on:{click:function(t){t.stopPropagation(),e.chooseBgImg=!0}}},[a("i",{staticClass:"el-icon-picture-outline"})]),a("el-button",{attrs:{type:"danger",icon:"el-icon-delete",size:"mini",circle:""},on:{click:e.onDeleBgImg}}),a("el-dialog",{attrs:{title:"选择背景图片",visible:e.chooseBgImg},on:{"update:visible":function(t){e.chooseBgImg=t}}},[a("div",{staticClass:"bgImg"},e._l(e.bgList,(function(t,n){return a("div",{key:n,staticClass:"bgImgItem",on:{click:function(t){return e.onSelectedImg(n)}}},[a("el-image",{staticStyle:{height:"160px"},attrs:{src:t.url,fit:"cover"}}),a("span",[e._v(e._s(t.name))])],1)})),0)])],1),a("div",{staticClass:"ph20 flex mt10"},[a("label",{staticClass:"mr5"},[e._v("背景网格:")]),a("el-switch",{attrs:{"active-color":"#13ce66","inactive-colori":"#ccc","active-value":!0,"inactive-value":!1},on:{change:e.changeGrid},model:{value:e.value,callback:function(t){e.value=t},expression:"value"}})],1)])])},v=[],x=a("c040"),w=x["a"],_=(a("854c"),a("cba8")),y=Object(_["a"])(w,m,v,!1,null,"1f03ee16",null),b=y.exports,g=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"menus",on:{click:function(t){return e.$emit("closeMenu")}}},[a("div",[a("a",{class:{disabled:e.Node.freeze},on:{click:function(t){return e.onTop()}}},[e._v("置顶")])]),a("div",[a("a",{class:{disabled:e.Node.freeze},on:{click:function(t){return e.onBottom()}}},[e._v("置底")])]),a("div",{staticClass:"line"}),a("div",[a("a",{on:{click:function(t){e.Node.freeze=!e.Node.freeze}}},[e._v(e._s(e.Node.freeze?"解冻":"冻结"))])]),a("div",[a("a",{class:{disabled:e.Node.freeze},on:{click:function(t){return e.del()}}},[e._v("删除")])]),a("div",{directives:[{name:"show",rawName:"v-show",value:"node"!==e.Node.type,expression:"Node.type!=='node'"}],staticClass:"line"}),a("div",{directives:[{name:"show",rawName:"v-show",value:"node"!==e.Node.type,expression:"Node.type!=='node'"}]},[a("a",{class:{disabled:e.Node.freeze},on:{click:function(t){return e.onCombine()}}},[e._v(e._s("extraGroup"==e.Node.type?"组合":"取消组合"))])]),a("div",{staticClass:"line"}),a("div",[a("a",{staticClass:"flex",class:{disabled:e.Node.freeze},on:{click:function(t){return e.clone()}}},[a("span",{staticClass:"full"},[e._v("克隆")])])])])},V=[],k=(a("6ba1"),{data:function(){return{}},props:{scene:{type:Object,require:!0},Node:{type:Object,require:!0}},methods:{onTop:function(){var e=this.scene.children.sort((function(e,t){return t.zIndex-e.zIndex}))[0].zIndex;this.Node.zIndex=e+1},onBottom:function(){var e=this.scene.children.sort((function(e,t){return e.zIndex-t.zIndex}))[0].zIndex;this.Node.zIndex=e-1},del:function(){this.scene.remove(this.Node)},clone:function(){var e=this.Node.clone(),t=e.position,a=t.x,n=t.y;this.scene.add(e),e.translate({x:a+10,y:n+10}),this.$emit("update",e)},onCombine:function(){"extraGroup"==this.Node.type?this.Node.combine():this.Node.unCombine()},onCopyImage:function(){this.scene.toImage({})}}}),P=k,S=(a("7110"),Object(_["a"])(P,g,V,!1,null,null,null)),C=S.exports,I=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"headers"},[a("el-menu",{staticClass:"menu",attrs:{mode:"horizontal","active-text-color":"#409EFF","background-color":"#2265ac","text-color":"#fff"},on:{select:e.onMenu}},[a("el-menu-item",{staticClass:"logo"},[a("router-link",{attrs:{to:"/"}},[a("div",{staticStyle:{display:"flex","align-items":"center","justify-content":"space-around"}},[a("i",{staticClass:"el-icon-arrow-left"}),a("span",[e._v("返回")])])])],1),a("el-submenu",{attrs:{index:"file"}},[a("template",{slot:"title"},[e._v("文件")]),a("el-menu-item",{attrs:{index:"open"}},[e._v("打开本地文件（新建）")]),a("el-menu-item",{attrs:{index:"replace"}},[e._v("导入本地文件...")]),a("el-menu-item",{staticClass:"separator"},[e._v("-------------------------------")]),a("el-menu-item",{attrs:{index:"save"}},[e._v("保存到本地")]),a("el-menu-item",{attrs:{index:"savePng"}},[e._v("下载为图片")])],2),a("el-submenu",{attrs:{index:"edit"}},[a("template",{slot:"title"},[e._v("编辑")]),a("el-menu-item",{attrs:{index:"undo"}},[e._v("撤消")]),a("el-menu-item",{attrs:{index:"redo"}},[e._v("重做")]),a("el-menu-item",{staticClass:"separator"},[e._v("-------------------------------")]),a("el-menu-item",{attrs:{index:"copy"}},[e._v("复制")]),a("el-menu-item",{attrs:{index:"cut"}},[e._v("剪切")]),a("el-menu-item",{attrs:{index:"paste"}},[e._v("粘贴")])],2),a("el-submenu",{attrs:{index:"share"}},[a("template",{slot:"title"},[e._v("社区")]),a("el-menu-item",{attrs:{index:"about"}},[e._v("咨询与建议")]),a("el-menu-item",[a("a",{attrs:{href:"",target:"_blank"}},[e._v("开源Github")])]),a("el-menu-item",[a("a",{attrs:{href:"",target:"_blank"}},[e._v("开发文档")])])],2),a("el-submenu",{attrs:{index:"help"}},[a("template",{slot:"title"},[e._v("帮助")]),a("el-menu-item",[a("a",{attrs:{href:"",target:"_blank"}},[e._v("在线官网")])]),a("el-menu-item",{attrs:{index:"license"}},[e._v("许可与申明")]),a("el-menu-item",{attrs:{index:"joinin"}},[e._v("资助与加入")]),a("el-menu-item",{attrs:{index:"about2"}},[e._v("关于")])],2)],1),a("el-menu",{staticClass:"full",attrs:{mode:"horizontal","background-color":"#2265ac","text-color":"#fff"}}),a("el-menu",{attrs:{mode:"horizontal","background-color":"#2265ac","active-text-color":"#409EFF","text-color":"#fff"},on:{select:e.onMenu}},[a("el-menu-item",{attrs:{index:"show"}},[a("i",{staticClass:"el-icon-video-play"}),a("span",[e._v("预览")])]),a("el-submenu",{attrs:{index:"scale",title:""}},[a("template",{slot:"title"},[e._v(" 视图比例："+e._s(e.scale)+"%（鼠标滚轮） ")]),a("el-menu-item",{on:{click:function(t){return e.resizeView("auto")}}},[e._v("自适应")]),a("el-menu-item",{on:{click:function(t){return e.resizeView("resize")}}},[e._v("重置")])],2),a("el-submenu",{attrs:{index:"state",title:"默认连线类型"}},[a("template",{slot:"title"},[a("i",{class:"iconfont icon-"+e.lineName})]),e._l(e.lineNames,(function(t,n){return a("el-menu-item",{key:n,attrs:{index:"line-"+t},on:{click:function(a){return e.onState("lineName",t)}}},[a("i",{class:"iconfont icon-"+t})])}))],2)],1),a("el-menu",{attrs:{mode:"horizontal","background-color":"#2265ac","active-text-color":"#409EFF","text-color":"#fff"}},[a("el-submenu",{attrs:{index:"state",title:"默认起点箭头"}},[a("template",{slot:"title"},[a("i",{class:"iconfont icon-from-"+e.fromArrowType})]),e._l(e.arrowTypes,(function(t,n){return a("el-menu-item",{key:n,attrs:{index:"fromArrow-"+t},on:{click:function(a){return e.onState("fromArrowType",t)}}},[a("i",{class:"iconfont icon-from-"+t})])}))],2)],1),a("el-menu",{attrs:{mode:"horizontal","background-color":"#2265ac","active-text-color":"#409EFF","text-color":"#fff"}},[a("el-submenu",{attrs:{index:"state",title:"默认终点箭头"}},[a("template",{slot:"title"},[a("i",{class:"iconfont icon-to-"+e.toArrowType})]),e._l(e.arrowTypes,(function(t,n){return a("el-menu-item",{key:n,attrs:{index:"toArrow-"+t},on:{click:function(a){return e.onState("toArrowType",t)}}},[a("i",{class:"iconfont icon-to-"+t})])}))],2)],1),a("el-menu",{attrs:{mode:"horizontal","background-color":"#2265ac","active-text-color":"#409EFF","text-color":"#fff"}},[e.user?a("el-submenu",{attrs:{index:"user"}},[a("template",{slot:"title"},[a("el-avatar",{attrs:{src:"https://cube.elemecdn.com/0/88/03b0d39583f48206768a7534e55bcpng.png",size:24}}),e._v(" "+e._s(e.user.username)+" ")],1),a("el-menu-item",{on:{click:e.onSignOut}},[e._v("退出")])],2):e._e(),e.user?e._e():a("el-menu-item")],1)],1)},N=[],E=a("faf4"),T=E["a"],M=(a("2922"),Object(_["a"])(T,I,N,!1,null,null,null)),D=M.exports,$=(a("2ea5"),a("82ae")),O=a.n($),z={data:function(){return{tools:[d,h,u,p,f],activeName:[0,1,2],animationId:null,canvas:null,scene:null,topoShow:!1,topoName:"1231",darwLine:!1,props:{node:null,line:null,nodes:null,multi:!1,expand:!1,locked:!1},Node:null,contextmenu:{left:null,top:null,bottom:null},lastTime:0}},components:{CanvasProps:b,CanvasContextMenu:C,HomeHeader:D},computed:{width:function(){return this.$store.state.collapse,"calc(100vw)"},event:function(){return this.$store.state.event},bkImage:function(){return this.$store.state.data.bkImage},bkColor:function(){return this.$store.state.data.bkColor},grid:function(){return this.$store.state.data.grid},websocket:function(){return this.$store.state.resetLink.count},changeNode:function(){return c.a.activeNode.name}},watch:{"scene.scaleVal":function(e){this.$store.commit("dataScale",e.x)},event:function(e){if(this["handle_"+e.name]){var t=c.a.getData();this["handle_"+e.name](t)}},grid:function(e){c.a.grid.show=e},bkImage:function(e){c.a.background.image=e},bkColor:function(e){c.a.background.color=e},websocket:function(){this.$store.state.data.websocket&&(this.canvas.data.websocket=this.$store.state.data.websocket,this.canvas.render())},$route:function(e){this.open()}},created:function(){this.$store.commit("changeGrid",c.a.grid.show),this.$store.commit("changeBkColor",c.a.background.color),this.$store.commit("changeBkImage",c.a.background.image)},methods:{onDrag:function(e,t){e.dataTransfer.setData("shape",JSON.stringify(t))},getData:function(){try{var e=event.dataTransfer.getData("shape"),t=JSON.parse(e);t.position={x:event.offsetX,y:event.offsetY},this.createNode(t),event.preventDefault()}catch(a){}},changeSceneScale:function(e){"resize"==e?this.scene.scale(this.scene.position,1,1):this.scene.resize()},initScene:function(e){this.data=this.$store.state.viewData,this.scene=new c.a.scene("#view2d-canvas",e)},animation:function(){this.scene.update(),this.lastTime=(new Date).getTime(),this.animationId=requestAnimationFrame(this.animation)},createNode:function(e){var t=new c.a.Node(e);this.scene.add(t),this.darwLine=!1},updateNode:function(e){this.Node=e,c.a.activeNode.helperBox=!1,c.a.activeNode=this.Node,c.a.activeNode.helperBox=!0},onClickBlank:function(){this.Node=c.a.activeNode,this.contextmenu.left=null},getLocked:function(e){var t=!0;if(e.nodes&&e.nodes.length){var a,n=Object(s["a"])(e.nodes);try{for(n.s();!(a=n.n()).done;){var i=a.value;if(!i.locked){t=!1;break}}}catch(c){n.e(c)}finally{n.f()}}if(t&&e.lines){var o,r=Object(s["a"])(e.lines);try{for(r.s();!(o=r.n()).done;){var l=o.value;if(!l.locked){t=!1;break}}}catch(c){r.e(c)}finally{r.f()}}return t},onUpdateProps:function(e){this.canvas.updateProps(e)},handle_new:function(e){this.canvas.open({nodes:[],lines:[]})},handle_open:function(e){this.handle_replace(e)},handle_replace:function(e){var t=this,a=document.createElement("input");a.type="file",a.onchange=function(e){var a=e.srcElement||e.target;if(a.files&&a.files[0]){a.files[0].name.replace(".json","");var n=new FileReader;n.onload=function(e){var a=e.target.result+"";try{var n=JSON.parse(a);n&&Array.isArray(n.pens)&&t.canvas.open(n)}catch(e){return!1}},n.readAsText(a.files[0])}},a.click()},handle_save:function(){c.a.save()},handle_savePng:function(e){c.a.saveAsImage()},handle_saveSvg:function(e){var t=new C2S(this.canvas.canvas.width+200,this.canvas.canvas.height+200),a=t.getSerializedSvg();a=a.replace("<defs/>","<defs>\n    <style type=\"text/css\">\n      @font-face {\n        font-family: 'topology';\n        src: url('http://at.alicdn.com/t/font_1331132_h688rvffmbc.ttf?t=1569311680797') format('truetype');\n      }\n    </style>\n    </defs>"),a=a.replace(/--le5le--/g,"&#x");var n=window.URL||window,i=new Blob([a]),o=n.createObjectURL(i),r=document.createElement("a");r.setAttribute("download",this.$store.state.file.name+".svg"),r.setAttribute("href",o);var s=document.createEvent("MouseEvents");s.initEvent("click",!0,!0),r.dispatchEvent(s)},handle_undo:function(e){this.canvas.undo()},handle_redo:function(e){console.log(87)},handle_copy:function(e){this.canvas.activeLayer.pens=this.copyNode(),this.canvas.copy()},copyNode:function(){var e=this,t=this.canvas,a=i(this.canvas.activeLayer.pens);t.clipboard=[];var n=[];return a.forEach((function(t){var a=e.Node.cloneState(t);n.push(a)})),n;function i(e){var t=Array.isArray(e)?[]:{};for(var a in e)e.hasOwnProperty(a)&&("object"===Object(r["a"])(e[a])&&null!==e[a]?t[a]=i(e[a]):t[a]=e[a]);return t}},handle_cut:function(e){this.canvas.cut()},handle_paste:function(e){this.canvas.paste()},handle_state:function(e){this.canvas.data[e.key]=e.value,this.$store.commit("change",{scale:this.canvas.data.scale||1,lineName:this.canvas.data.lineName,fromArrowType:this.canvas.data.fromArrowType,toArrowType:this.canvas.data.toArrowType,fromArrowlockedType:this.canvas.data.locked,bkColor:this.canvas.data.bkColor,bkImage:this.canvas.data.bkImage,gird:this.canvas.data.gird||!0,websocket:this.canvas.data.websocket})},handle_show:function(e){this.$store.commit("addView",e);var t=JSON.stringify(e);this.$router.push({name:"preview",params:{pageData:t}})},onContextMenu:function(e){e.preventDefault(),e.stopPropagation(),null!==c.a.activeNode?(this.Node=c.a.activeNode,e.clientY+360<document.body.clientHeight?this.contextmenu={left:e.clientX+"px",top:e.clientY+"px"}:this.contextmenu={left:e.clientX+"px",bottom:document.body.clientHeight-e.clientY+"px"}):this.contextmenu={left:null,top:null}},onCreateTopo:function(){this.topoShow=!1,this.$store.commit("changeFileName",this.topoName)},getJsonData:function(){return Object(o["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,O.a.get("./json/View2d_data_48227133.json");case 2:e.sent;case 3:case"end":return e.stop()}}),e)})))()}},mounted:function(){var e=this.$store.state.viewData;this.initScene(e),this.animation(),window.onresize=this.scene.resize},destroyed:function(){cancelAnimationFrame(this.animationId)}},L=z,A=(a("1e07"),Object(_["a"])(L,n,i,!1,null,null,null));t["default"]=A.exports},7110:function(e,t,a){"use strict";a("0fc5")},"79a5":function(e,t,a){e.exports=a.p+"static/img/line.1190dc13.svg"},"7df9":function(e,t,a){},"80c7":function(e,t,a){e.exports=a.p+"static/img/barCharts.cfaeb9bf.svg"},"854c":function(e,t,a){"use strict";a("a43f")},"8e30":function(e,t,a){e.exports=a.p+"static/img/radarCharts.474d2a35.svg"},"929d":function(e,t,a){e.exports=a.p+"static/img/gaugeCharts.d1d2b602.svg"},"9bfe":function(e,t,a){e.exports=a.p+"static/img/light.7a4d29c0.svg"},"9dce":function(e,t,a){e.exports=a.p+"static/img/fiveAngle.daf61f59.svg"},"9f0b":function(e,t,a){e.exports=a.p+"static/img/center.5aca8737.svg"},a43f:function(e,t,a){},aae0:function(e,t,a){e.exports=a.p+"static/img/arc.f465a56c.svg"},accc:function(e,t,a){e.exports=a.p+"static/img/windmill.cd3352c5.svg"},b91d:function(e,t,a){e.exports=a.p+"static/img/channel.93fb8f84.svg"},c040:function(module,__webpack_exports__,__webpack_require__){"use strict";var H_workSpace_View2d_node_modules_babel_runtime_7_16_0_babel_runtime_helpers_esm_createForOfIteratorHelper__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("02a9"),H_workSpace_View2d_node_modules_babel_runtime_7_16_0_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("b5e5"),H_workSpace_View2d_node_modules_babel_runtime_7_16_0_babel_runtime_helpers_esm_typeof__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("fef3"),H_workSpace_View2d_node_modules_babel_runtime_7_16_0_babel_runtime_helpers_esm_objectSpread2__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("a19a"),regenerator_runtime_runtime_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("e186"),regenerator_runtime_runtime_js__WEBPACK_IMPORTED_MODULE_4___default=__webpack_require__.n(regenerator_runtime_runtime_js__WEBPACK_IMPORTED_MODULE_4__),core_js_modules_es_function_name_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("3e22"),core_js_modules_es_function_name_js__WEBPACK_IMPORTED_MODULE_5___default=__webpack_require__.n(core_js_modules_es_function_name_js__WEBPACK_IMPORTED_MODULE_5__),core_js_modules_es_json_stringify_js__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("16e1"),core_js_modules_es_json_stringify_js__WEBPACK_IMPORTED_MODULE_6___default=__webpack_require__.n(core_js_modules_es_json_stringify_js__WEBPACK_IMPORTED_MODULE_6__),core_js_modules_es_object_to_string_js__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("a9b6"),core_js_modules_es_object_to_string_js__WEBPACK_IMPORTED_MODULE_7___default=__webpack_require__.n(core_js_modules_es_object_to_string_js__WEBPACK_IMPORTED_MODULE_7__),core_js_modules_web_dom_collections_for_each_js__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("c284"),core_js_modules_web_dom_collections_for_each_js__WEBPACK_IMPORTED_MODULE_8___default=__webpack_require__.n(core_js_modules_web_dom_collections_for_each_js__WEBPACK_IMPORTED_MODULE_8__),core_js_modules_es_array_splice_js__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("8d1b"),core_js_modules_es_array_splice_js__WEBPACK_IMPORTED_MODULE_9___default=__webpack_require__.n(core_js_modules_es_array_splice_js__WEBPACK_IMPORTED_MODULE_9__),core_js_modules_es_array_concat_js__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__("44ad"),core_js_modules_es_array_concat_js__WEBPACK_IMPORTED_MODULE_10___default=__webpack_require__.n(core_js_modules_es_array_concat_js__WEBPACK_IMPORTED_MODULE_10__),element_ui__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__("5422"),element_ui__WEBPACK_IMPORTED_MODULE_11___default=__webpack_require__.n(element_ui__WEBPACK_IMPORTED_MODULE_11__);__webpack_exports__["a"]={data:function(){return{events:{type:0,action:0,value:"",params:"",APIType:"get",bindValue:""},group:[],equipment:[],sensor:[],backgroundType:0,selectedSensor:null,showSelectedColor:[],drawType:"fill",typeOption:[{value:1,text:"开关"},{value:2,text:"文本信息"},{value:3,text:"状态显示"}],selectedSensorType:"",showData:null,animation:null,resData:null,textName:"ptName",data:null,nodeId:null,nodeData:"",lineDash:0,bgColor:"透明",activeName:"first",nodeIsJson:!1,chooseBgImg:!1,position:{},scaleVal:{},rotateVal:0,value:!1,webscoketOption:{url:"ws://111.231.106.94:8088/websocket/25",animate:!1,showInfo:!1},lineOption:[{label:"—————",value:0},{label:"------------",value:1},{label:"- - - - - - -",value:2},{label:"- · - · - · - ·",value:3}],weightOption:[{label:"正常",value:"normal"},{label:"加粗",value:"bolder"}],fontStyleOption:[{label:"正常",value:"normal"},{label:"倾斜",value:"italic"}],textAlignOption:[{label:"居左",value:"left"},{label:"居中",value:"center"},{label:"居右",value:"right"}],textVerticalOption:[{label:"居顶",value:"top"},{label:"居中",value:"center"},{label:"居底",value:"bottom"}],APIUrl:"https://yun.kexsci.com/yun/api/echart/countProjectStatus",APIType:"get",APIParams:"",bindValue:"",fileName:"",bgList:[{url:"https://ss2.bdstatic.com/70cFvnSh_Q1YnxGkpoWK1HF6hhy/it/u=3156148005,3827021055&fm=26&gp=0.jpg",name:"背景1"},{url:"https://ss0.bdstatic.com/70cFvHSh_Q1YnxGkpoWK1HF6hhy/it/u=1898783846,176692612&fm=26&gp=0.jpg",name:"背景2"},{url:"https://ss0.bdstatic.com/70cFvHSh_Q1YnxGkpoWK1HF6hhy/it/u=1242645534,4182724318&fm=26&gp=0.jpg",name:"背景3"},{url:"./img/star.jpg",name:"背景4"},{url:"./img/star1.jpg",name:"背景5"},{url:"./img/sky.jpg",name:"背景6"}]}},props:{name:{type:String,default:"kx-topo"},Node:{type:Object,require:!0}},updated:function(){},watch:{name:function(){this.fileName=this.name},Node:{handler:function(){null!==this.Node&&(this.position=Object(H_workSpace_View2d_node_modules_babel_runtime_7_16_0_babel_runtime_helpers_esm_objectSpread2__WEBPACK_IMPORTED_MODULE_3__["a"])({},this.Node.position),this.scaleVal=Object(H_workSpace_View2d_node_modules_babel_runtime_7_16_0_babel_runtime_helpers_esm_objectSpread2__WEBPACK_IMPORTED_MODULE_3__["a"])({},this.Node.scaleVal),this.rotateVal=this.Node.rotateVal)},deep:!0},"Node.ID":function(){if(!this.Node)return!1;this.drawType=this.Node.drawType;var e=null;switch(e="node"==this.Node.type?JSON.stringify(this.Node.border.lineDash):JSON.stringify(this.Node.lineDash),e){case"[0,0]":this.lineDash=0;break;case"[5,5]":this.lineDash=1;break;case"[5,10]":this.lineDash=2;break;case"[5,5,1,5]":this.lineDash=3;break}}},methods:{onchangePos:function(){this.Node.translate(this.position)},onSelectedSensor:function(){},openSelected:function(e){"object"==Object(H_workSpace_View2d_node_modules_babel_runtime_7_16_0_babel_runtime_helpers_esm_typeof__WEBPACK_IMPORTED_MODULE_2__["a"])(this.Node.color[e])?(this.backgroundType="linear"==this.Node.color[e].type?1:2,this.Node.color[e]={type:this.Node.color[e].type,direction:this.Node.color[e].direction,gradient:[this.Node.color[e].gradient[0],this.Node.color[e].gradient[1]]}):this.backgroundType=0},selectedType:function(e){if(0!=this.backgroundType){var t=1==this.backgroundType?"linear":"radial",a=1==this.backgroundType?"to right":"center";this.$set(this.Node.color,e,{type:t,direction:a,gradient:["#ff00ff","#adccff"]})}else this.$set(this.Node.color,e,"#2cafe7")},onLinkSensor:function(){if(this.selectedSensor)if(this.selectedSensorType)switch(Object(element_ui__WEBPACK_IMPORTED_MODULE_11__["Notification"])({type:"success",message:"连接成功",duration:1500}),this.Node.title=this.selectedSensor,1*this.selectedSensorType){case 1:break;case 2:this.webscoketOption.showInfo=!0,this.onLinkWebscoket();break;case 3:this.webscoketOption.animate=!0,this.onLinkWebscoket();break}else Object(element_ui__WEBPACK_IMPORTED_MODULE_11__["Notification"])({type:"warning",message:"请设置类型！",duration:1500});else Object(element_ui__WEBPACK_IMPORTED_MODULE_11__["Notification"])({type:"warning",message:"请选择传感器！",duration:1500})},initData:function(){this.APIUrl="https://yun.kexsci.com/yun/api/echart/countProjectStatus",this.APIType="get",this.APIParams="",this.Node.data=null,this.events={type:0,action:0,value:"",params:"",APIType:"get",bindValue:""}},changeDrawType:function(){var e=this;"node"==this.Node.type?this.Node.drawType=this.drawType:this.Node.traverse((function(t){"node"==t.type&&(t.drawType=e.drawType)}))},onChangeFileName:function(){this.$store.commit("changeFileName",this.fileName)},onChangeColor:function(e){0==this.backgroundType&&this.$store.commit("changeBkColor",this.bgColor)},lineDashChange:function(){var e=[0,0];switch(this.lineDash){case 0:e=[0,0];break;case 1:e=[5,5];break;case 2:e=[5,10];break;case 3:e=[5,5,1,5];break}"line"!==this.Node.type?this.Node.border.lineDash=e:this.Node.lineDash=e},onSelectedImg:function(e){this.chooseBgImg=!1,this.$store.commit("changeBkImage",this.bgList[e].url)},onDeleBgImg:function(){this.$store.commit("changeBkImage","")},changeGrid:function(){this.$store.commit("changeGrid",this.value)},onChange:function(e){this.$emit("change",this.Node)},onSelected:function(){this.onChange()},onSelectEventDo:function(e,t){},changeExpand:function(){},isJson:function(e){return"object"==Object(H_workSpace_View2d_node_modules_babel_runtime_7_16_0_babel_runtime_helpers_esm_typeof__WEBPACK_IMPORTED_MODULE_2__["a"])(e)&&"[object object]"==Object.prototype.toString.call(e).toLowerCase()&&!e.length},onLinkWebscoket:function(){this.webscoketOption.url?(this.$store.commit("changeWebscoket",this.webscoketOption.url),this.$store.commit("resetWebScoket"),this.addEvents()):this.$message({type:"error",message:"Url地址为空!",duration:1500,center:!0})},offLinkWebscoket:function(){var e=this;this.events.bindValue="",this.Node.events.forEach((function(t,a){2==t.type&&e.Node.events.splice(a,1)}))},addEvents:function(){this.events.value=this.webscoketFn(),this.events.type=2,this.events.action=2,this.events.bindValue=this.textName},onLinkAPI:function onLinkAPI(node,item){var _this3=this;return Object(H_workSpace_View2d_node_modules_babel_runtime_7_16_0_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_1__["a"])(regeneratorRuntime.mark((function _callee(){var params,res;return regeneratorRuntime.wrap((function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:if(item&&(_this3.APIParams=item.APIParams,_this3.APIUrl=item.APIUrl,_this3.APIType=item.APIType),params=_this3.APIParams?eval("("+_this3.APIParams+")"):{},res=null,"get"!=_this3.APIType){_context.next=9;break}return _context.next=6,_this3.$axios.get(_this3.APIUrl,{params:params});case 6:res=_context.sent,_context.next=12;break;case 9:return _context.next=11,_this3.$axios.post(_this3.APIUrl,params);case 11:res=_context.sent;case 12:_this3.showData=node.data=JSON.stringify(res),(item?item.bindValue:item)&&(node.text=eval("res."+item.bindValue));case 14:case"end":return _context.stop()}}),_callee)})))()},onBindAPI:function(){var e=this;this.onLinkAPI();var t=!1,a={type:200,action:200,url:this.APIUrl,pramas:this.APIParams,bindValue:this.bindValue,method:this.APIType};this.Node.events.forEach((function(n,i){200==n.type&&(e.Node.events[i]=a,t=!0)})),t||this.Node.events.push(a),this.$emit("change",this.Node)},webscoketFn:function(){if(!this.textName)return"";var e="";return this.webscoketOption.showInfo&&(e+="\n          let info = {name: params.ptName, status: params.ptStatus, data: params.deflection};\n          pen.text = JSON.stringify(info)"),this.webscoketOption.animate&&(e+="\n          switch(params.ptStatus*1){\n            case 0: pen.fillStyle = '#eeeeee';\n            break;\n            case 1: pen.fillStyle = '#00ff00';\n            break;\n            case 2: pen.fillStyle = '#ff0000';\n            break;\n          }\n          window['flash_animate'](pen);"),"if(pen.title == params.".concat(this.textName,"){\n          ").concat(e,"\n          window['updateCanvasNode'](pen);\n        }")},flash_animation:function(e){e.animateFrames=[];var t=this.Node.cloneState(e);t.fillStyle="#eeeeee",e.animateFrames.push({duration:300,linear:!0,state:t});var a=this.Node.cloneState(e);a.fillStyle=e.fillStyle,e.animateFrames.push({duration:300,linear:!0,state:a}),e.animateDuration=0;var n,i=Object(H_workSpace_View2d_node_modules_babel_runtime_7_16_0_babel_runtime_helpers_esm_createForOfIteratorHelper__WEBPACK_IMPORTED_MODULE_0__["a"])(e.animateFrames);try{for(i.s();!(n=i.n()).done;){var o=n.value;e.animateDuration+=o.duration}}catch(r){i.e(r)}finally{i.f()}e.animateStart=Date.now()}},mounted:function(){this.bgColor=this.$store.state.data.bkColor||"",this.value=this.$store.state.data.grid,this.group=this.$store.state.userEquipment.userEquipmentGroup}}},ce6f:function(e,t,a){e.exports=a.p+"static/img/fan.86dcc3a0.svg"},e2ef:function(e,t,a){"use strict";a("6aae")},e734:function(e,t,a){e.exports=a.p+"static/img/pool.faeafc15.svg"},ea63:function(e,t,a){e.exports=a.p+"static/img/clock.7f284f84.svg"},ec75:function(e,t,a){e.exports=a.p+"static/img/video.5a4d94f5.svg"},f788:function(e,t,a){e.exports=a.p+"static/img/pieCharts.f5c05908.svg"},fa14:function(e,t,a){e.exports=a.p+"static/img/picture.546d9084.svg"},fa2d:function(e,t,a){e.exports=a.p+"static/img/eightAngle.c7b8229a.svg"},faf4:function(e,t,a){"use strict";(function(e){var n=a("b5e5");a("e186");t["a"]={data:function(){return{about:!1,license:!1,joinin:!1,lineNames:["curve","polyline","line"],arrowTypes:["","triangleSolid","triangle","diamondSolid","diamond","circleSolid","circle","line","lineUp","lineDown"],user:null}},created:function(){},computed:{scale:function(){return Math.ceil(100*this.$store.state.data.scale)},lineName:function(){return this.$store.state.data.lineName},fromArrowType:function(){return this.$store.state.data.fromArrowType},toArrowType:function(){return this.$store.state.data.toArrowType},error:function(){return this.$store.state.error}},watch:{error:function(e){this.$notify({title:"错误",type:"error",message:e.text})}},methods:{resizeView:function(e){this.$emit("change",e)},onMenu:function(e,t){if(e&&0!==e.indexOf("/"))switch(e){case"new":break;case"open":this.$store.commit("emit",{name:e});break;case"about":case"about2":this.about=!0;break;case"license":this.license=!0;break;case"joinin":this.joinin=!0;break;case"show":this.$store.commit("emit",{name:e});break;default:this.$store.commit("emit",{name:e});break}},onState:function(e,t){this.$store.commit("emit",{name:"state",data:{key:e,value:t}})},getUser:function(){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!e.$cookies.get("token")){t.next=4;break}return t.next=3,e.$axios.$get("/api/user/profile");case 3:e.user=t.sent;case 4:case"end":return t.stop()}}),t)})))()},onLogin:function(){e.client&&(location.href="https://account.le5le.com?cb=".concat(encodeURIComponent(location.href)))},onSignOut:function(){this.$cookies.remove("token"),this.user=null}}}}).call(this,a("eef6"))}});
//# sourceMappingURL=app.f998202c.js.map